// @ts-nocheck
require(["esri/WebMap","esri/views/MapView","esri/layers/FeatureLayer","esri/layers/ImageryLayer","esri/layers/MapImageLayer","esri/core/reactiveUtils","esri/Graphic","esri/geometry/geometryEngine","esri/layers/GraphicsLayer","esri/widgets/Sketch/SketchViewModel","esri/widgets/DistanceMeasurement2D","esri/widgets/AreaMeasurement2D","esri/widgets/BasemapLayerList","esri/widgets/Bookmarks","esri/widgets/Legend","esri/widgets/Print","esri/layers/support/TileInfo","esri/geometry/Extent","esri/rest/support/PrintTemplate","esri/rest/support/PrintParameters","esri/widgets/Print/PrintViewModel","esri/widgets/Print/TemplateOptions"],(function(e,t,a,n,i,r,s,l,o,d,c,u,p,m,h,g,f,y,b,v,w,x){const _=new URLSearchParams(window.location.search);let T=window.location.href,I=_.get("viewer");let L=["colebrookct","columbiact","durhamct","haddamct","northcanaanct","roxburyct","roxburyctassessor","scotlandct","warrenct","warrenctassessor","washingtonct","wiltonct","wolcottct"].join("|"),S=new RegExp(`\\?viewer=cama\\/(${L})(\\&\\w+=\\w+)*$`);null!=I&&S.test(T)?(I+=".json",$("#whole-app").show()):"https://terrenogis.com"===window.location.href||"https://terrenogis.com/"===window.location.href?window.location.href="https://www.qds.biz/gis-service":window.location.href="./onload.html";const M={mapId:"",condoLayer:"",title:"",isCondosLayer:"",noCondoLayer:""};fetch(I).then((e=>e.json())).then((f=>{f.layers;function y(e){var t=new Date(e),a=t.getDate();return t.getMonth()+1+"/"+a+"/"+t.getFullYear()}M.mapId=f.webmapId||"6448b08504de4244973a28305b18271f",M.condoLayer=f.condoLayer,M.noCondoLayer=f.noCondoLayer,M.title=f.title,M.isCondosLayer=f.condos,M.masterTable=f.masterTable,M.zoom=f.zoom,M.parcelZoom=f.parcelZoom,M.imageUrl=f.imageUrl,M.welcomeImage=f.welcomeImage,M.pdf_Image=f.pdf_Image,M.pdf_demo=f.pdf_demographics,M.taxMap_Url=f.taxMapUrl,M.parcelMapUrl=f.parcelMapUrl,M.housingUrl=f.housingUrl,M.propertyCardPdf=f.propertyCardPdf,M.propertyCard=f.propertyCard,M.tax_bill=f.tax_bill,M.useVisionForTaxBillUrl=f.useVisionForTaxBillUrl,M.accessorName=f.accessorName,M.parcelTitle=f.parcelServiceTitle,M.tabTitle=f.tabTitle,M.basemapTitle=f.basemapTitle,M.parcelRenderer=f.parcelRenderer,M.useUniqueIdforParcelMap=f.useUniqueIdforParcelMap,M.helpUrl=f.helpUrl,M.includeFilter=f.includeFilter,M.customWelcomePage=f.customWelcomePage,M.customWelcomeMessage=f.customWelcomeMessage,M.showDisclaimer=f.showDisclaimer,M.customDisclaimerPage=f.customDisclaimerPage,M.customDisclaimerMessage=f.customDisclaimerMessage,M.DetailLinks=f.DetailLinks,M.DetailLinksToInclude=f.DetailLinksToInclude,M.includePermitLink=f.includePermitLink,M.scale=f.scale,"no"===M.showDisclaimer&&(sessionStorage.setItem("agreedToDisclaimer","yes"),$("#starterModal").modal("hide")),"yes"===M.customWelcomePage&&(document.getElementById("welcomeMessage").innerHTML=M.customWelcomeMessage),"yes"===M.customDisclaimerPage&&(document.getElementById("disclaimer-text").innerHTML=M.customDisclaimerMessage),"yes"===M.includePermitLink&&(M.permitLink=f.permitLink),document.getElementById("AccessorName").innerHTML=f.accessorName,$(".help-url").attr("href",M.helpUrl),document.getElementById("title").innerHTML=M.title,document.getElementById("print-title").innerHTML=M.title,document.getElementById("imageContainer").src=M.welcomeImage,document.getElementById("print-image").src=M.welcomeImage,document.getElementById("tab-title").innerHTML=M.tabTitle;const b="No geometry";sessionStorage.setItem("condos",M.isCondosLayer);const v=new o,w=new o,_=new e({portalItem:{id:M.mapId},layers:[v]});var T=new t({container:"viewDiv",map:_,units:"imperial",scale:M.scale,popupEnabled:!1,ui:{components:["attribution"]}});T.when((()=>{M.homeExtent=T.extent})),"no"===M.includeFilter&&$("#filterButton").remove(),T.when((()=>{"yes"==sessionStorage.getItem("agreedToDisclaimer")||1==L?$("#starterModal").modal("hide"):$("#starterModal").modal("show"),$(document).ready((function(){$("#agreeBtn").prop("disabled",!0),$("#agreeCheck").change((function(){$(this).is(":checked")?($("#agreeBtn").prop("disabled",!1),sessionStorage.setItem("agreedToDisclaimer","yes")):$("#agreeBtn").prop("disabled",!0)}))}))})),T.when((()=>{document.getElementById("urlButton").addEventListener("click",(function(e){let t=urlInput.value;t.length>0&&function(){let e=new a({url:`${t}`});e.load().then((()=>{_.add(e),$("#urlMessage").html('<strong><p style="color:green;">Successfully uploaded REST Service.</p></strong>'),_.layers.on("change",(function(e){console.log(e," layer was added/removed from the map.")}));var t=$("#layerList");Le(e,t),urlInput.value=""})).catch((e=>{$("#urlMessage").html('<strong><p style="color:red;">Error uploading REST Service.</p></strong>'),console.error("Error loading the FeatureLayer:",e)}))}()}))})),T.when((()=>{document.getElementById("urlButtonImagery").addEventListener("click",(function(e){let t=urlInputImagery.value;t.length>0&&function(){let e=new n({url:`${t}`});e.load().then((()=>{_.add(e),$("#urlMessageImagery").html('<strong><p style="color:green;">Successfully uploaded REST Service.</p></strong>'),_.layers.on("change",(function(e){console.log(e," layer was added/removed from the map.")}));var t=$("#layerList");Le(e,t),urlInput.value=""})).catch((e=>{$("#urlMessageImagery").html('<strong><p style="color:red;">Error uploading REST Service.</p></strong>'),console.error("Error loading the FeatureLayer:",e)}))}()}))})),T.when((()=>{document.getElementById("urlButtonMapService").addEventListener("click",(function(e){let t=urlInputMapService.value;t.length>0&&function(){let e=new i({url:`${t}`});e.load().then((()=>{_.add(e),$("#urlMessageMapService").html('<strong><p style="color:green;">Successfully uploaded REST Service.</p></strong>'),_.layers.on("change",(function(e){console.log(e," layer was added/removed from the map.")}));var t=$("#layerList");Le(e,t),urlInput.value=""})).catch((e=>{$("#urlMessageMapService").html('<strong><p style="color:red;">Error uploading REST Service.</p></strong>'),console.error("Error loading the FeatureLayer:",e)}))}()}))})),T.when((()=>{const e=_.layers.items.filter((e=>!("group"===e.type&&e.title&&"hidden group"===e.title.toLowerCase()||e.title&&e.title===`${M.parcelTitle}`)));new h({view:T,container:$("#LegendDiv")[0],layerInfos:e.map((e=>({layer:e})))})})),T.when((()=>{new m({view:T,container:$("#BookmarksDiv")[0],dragEnabled:!0})}));new x({title:"Print Map at Scale 1:1200",layout:"a4-portrait",scale:1200,scaleEnabled:!0,dpi:96,legendEnabled:!0,northArrowEnabled:!0}),new x({title:"Print Map at Scale 1:2400",layout:"a4-portrait",scale:2400,scaleEnabled:!0,dpi:96,legendEnabled:!0,northArrowEnabled:!0});T.when((()=>{new g({view:T,container:$("#PrintDiv")[0],templateOptions:{title:"Print Map at Scale 1:1200",layout:"a4-portrait",scale:1200,scaleEnabled:!0,dpi:96,legendEnabled:!0,northArrowEnabled:!0},allowedLayouts:["letter-ansi-a-landscape","letter-ansi-a-portrait","tabloid-ansi-b-landscape","tabloid-ansi-b-portrait","a3-landscape","a3-portrait","a4-landscape","a4-portrait"]})})),T.when((()=>{let e;new p({view:T,container:$("#BasemapDiv")[0],dragEnabled:!0}).visibleElements={statusIndicators:!0,baseLayers:!0,referenceLayers:!1,referenceLayersTitle:!1,errors:!0,heading:!1};let t={type:"simple",symbol:{type:"simple-fill",color:[255,255,255,0],outline:{width:1,color:`${M.parcelRenderer}`}}},a={type:"simple",symbol:{type:"simple-fill",color:[255,255,255,0],outline:{width:1,color:"#897044"}}};T.map.allLayers.forEach((t=>{"Parcel Boundaries"===t.title&&(e=t.renderer)}));const n=["Aerial-Ortho 2023","Aerial-Ortho 2019","Aerial-Ortho 2016","Aerial-Ortho 2012"];T.map.allLayers.some((e=>n.includes(e.title)&&e.visible))&&T.map.allLayers.forEach((e=>{"Parcel Boundaries"===e.title&&(e.renderer=t)})),e="yes"===sessionStorage.getItem("condos")?_e.renderer:xe.renderer;const i={};T.map.basemap.baseLayers.forEach((e=>{i[e.id]=e.visible})),r.watch((()=>T.map.basemap.baseLayers.map((e=>e.visible))),(()=>{console.log("Visibility changed:",T.map.basemap.baseLayers.map((e=>({title:e.title,visible:e.visible})))),function(e,n){let i=e.find((e=>e.visible&&!n[e.id]));if(i)console.log(`Newly visible layer: ${i.title}`),e.forEach((e=>{e!==i&&(e.visible=!1)})),i.title!==`${M.basemapTitle}`&&"Washington Basemap"!==i.title?"yes"===sessionStorage.getItem("condos")?_e.renderer=t:xe.renderer=t:T.map.allLayers.forEach((e=>{"Parcel Boundaries"===e.title&&(e.renderer=a)}));else{0===e.filter((e=>e.visible)).length&&e.forEach((e=>{e.visible=n[e.id]}))}e.forEach((e=>{n[e.id]=e.visible})),console.log("Updated visibility tracker:",e.map((e=>({title:e.title,wasVisible:n[e.id]}))))}(T.map.basemap.baseLayers,i)}))})),_.add(w);let I,L,S,B,E,C,P,D,k,A,F,N,O,R,U,q,V=!1,z=!1,G=!1,K=!1,j=[],H=[],Z=!1,W="feet",Q=!1,J=!1,Y=!1,X={isChanged:!1,item:""},ee=!1,te=document.getElementById("buffer-value");const ae=document.getElementById("clear-btn1"),ne=document.getElementById("clear-btn2");let ie,re,se,le,oe,de,ce,ue,pe,me,he,ge=T.extent,fe=T.scale,$e=T.zoom;r.watch((()=>[T.zoom,T.extent,T.scale]),(([e,t,a],[n])=>{if(e){if(e!==$e&&($e=e),!xe.visible&&!_e.visible&&Number(e)>M.parcelZoom){if("no"===sessionStorage.getItem("condos")?xe.visible=!0:_e.visible=!0,R&&(R?.remove(),R=null),U&&(U?.remove(),U=null),"click"==ie||"details"==ie||"none yet"==ie)return void $("#select-button").removeClass("btn-warning");U=T.on("click",We),$("#lasso").removeClass("btn-warning"),$("#select-button").addClass("btn-warning"),J=!0}}else n&&(ge=t,fe=a,$e=e);return""}));let ye=document.getElementById("topbar");T.ui.add(ye,"bottom-right");let be=null;function ve(e){switch(e){case"distance":if(be=new c({view:T,unit:"feet"}),be.viewModel.start(),R||U||(ie="none yet"),R)try{ie="details",R?.remove(),R=null}catch(e){console.error("Failed to remove DetailsHandle",e)}if(U)try{ie="click",U.remove()}catch(e){console.error("Failed to remove DetailsHandle",e)}be&&be.viewModel&&be.viewModel.watch("state",(function(e){"measured"===e&&("click"==ie?U=T.on("click",We):"details"==ie&&(R=T.on("click",Ze)))})),T.ui.add(be,"bottom-right"),we(document.getElementById("distanceButton"));break;case"area":if(be=new u({view:T,unit:"acres"}),be.viewModel.start(),R||U||(ie="none yet"),R)try{ie="details",R?.remove(),R=null}catch(e){console.error("Failed to remove DetailsHandle",e)}if(U)try{ie="click",U?.remove(),U=null}catch(e){console.error("Failed to remove DetailsHandle",e)}be&&be.viewModel&&be.viewModel.watch("state",(function(e){"measured"===e&&("click"==ie?U=T.on("click",We):"details"==ie&&(R=T.on("click",Ze)))})),T.ui.add(be,"bottom-right"),we(document.getElementById("areaButton"));break;case null:be&&(T.ui.remove(be),be.destroy(),be=null)}}function we(e){T.focus();let t=Array.from(document.getElementsByClassName("active"));for(let e=0;e<t.length;e++)t[e].classList.remove("active","btn-warning");e&&(e.classList.add("active","btn-warning"),e.classList.remove("bg-info"))}document.getElementById("distanceButton").addEventListener("click",(function(){ve(null),this.classList.contains("active")?we(null):ve("distance")})),document.getElementById("areaButton").addEventListener("click",(function(){ve(null),this.classList.contains("active")?we(null):ve("area")}));let xe=new a({url:`${M.noCondoLayer}`,visible:!1,popupEnabled:!0,title:"Parcel Boundaries",id:"noCondoLayer"}),_e=new a({url:`${M.condoLayer}`,visible:!1,popupEnabled:!0,title:"Parcel Boundaries",id:"condoLayer"});const Te=new a({url:`${M.masterTable}`}),Ie=new a({url:`${M.masterTable}`});function Le(e,t){let a;if(a="yes"===sessionStorage.getItem("condos")?"noCondoLayer":"condoLayer","graphics"!==e.type&&"Tax Map Annotation"!=e.title&&"Road Centerline"!=e.title&&null!=e.title&&""!=e.title&&e.id!=a){var n;n=e.visible?"check-square":"square";var i=$(`\n          <calcite-list-item scale="m" label="${e.title}" value="${e.id}" style="border: white 0.5px solid;">\n          <calcite-action class="toggle-slider" id="action-${e.id}-dropdown" slot="actions-end" icon="sliders-horizontal" text="${e.title}"></calcite-action>\n            <calcite-action class="layer-vis" id="action-${e.id}" slot="actions-end" icon="${n}" text="${e.title}"></calcite-action>\n            <div id="opacityDiv-${e.id}" class="esri-slider esri-widget esri-slider--horizontal opacity-div " touch-action="none" style="display: none; height: 45px; align-items: center; padding-bottom: 10px; padding-left: 10px;">\n              <label style="margin-right: 10px; padding-top: 20px; font-weight: 500;font-size: 12px;">Layer Opacity (%)</label>\n              <calcite-slider class="slider-opacity" id="${e.id}" style="width: 50%;" value="100" label-handles max-label="100" max-value="100" min-label="0"></calcite-slider>\n              </calcite-slider>\n            </div>\n          </calcite-list-item>\n      `);t.append(i)}}function Se(e,t){e.forEach((function(e){if("group"===e.type){if(e.title&&"hidden group"===e.title.toLowerCase())return;var a=e.title||"Industry",n=$(`\n              <calcite-accordion scale="m">\n                <calcite-accordion-item heading="${a}">\n                </calcite-accordion-item>\n              </calcite-accordion>`);Se(e.layers.items,n.find("calcite-accordion-item")),t.append(n)}else Le(e,t)}))}function Me(e){de=e}function Be(e){const t=$(e);"CALCITE-COMBOBOX"===t[0].tagName?(t[0].open=!1,t[0].disabled=!0,t[0].placeholder="Loading..."):"CALCITE-INPUT-TEXT"===t[0].tagName?(t[0].loading=!0,t[0].disabled=!0,t[0].placeholder="Loading..."):"CALCITE-DATE-PICKER"===t[0].tagName&&(t[0].disabled=!0)}function Ee(e,t){const a=$(e);"CALCITE-COMBOBOX"===a[0].tagName?(a[0].disabled=!1,a[0].placeholder=`${t}`):"CALCITE-INPUT-TEXT"===a[0].tagName?(a[0].disabled=!1,a[0].loading=!1,a[0].placeholder=`${t}`):"CALCITE-DATE-PICKER"===a[0].tagName&&(a[0].disabled=!1)}_.add(xe),_.add(_e),me=[{layer:_e,field:"Appraised_Total",filterSelector:"#app-val-min",filterSelector2:"#app-val-max"},{layer:_e,field:"Assessed_Total",filterSelector:"#assess-val-min",filterSelector2:"#assess-val-max"},{layer:_e,field:"Total_Acres",filterSelector:"#acres-val-min",filterSelector2:"#acres-val-max"},{layer:_e,field:"Sale_Date",filterSelector:"#sold_calendar_lowest",filterSelector2:"#sold_calendar_highest"},{layer:_e,field:"Sale_Price",filterSelector:"#saleP-val-min",filterSelector2:"#saleP-val-max"}],pe=[{layer:_e,field:"Street_Name",filterSelector:"#streetFilter",alias:"Street_Name",message:"Select a Street Name"},{layer:_e,field:"Owner",filterSelector:"#ownerFilter",message:"Select a Owner"},{layer:_e,field:"Parcel_Type",filterSelector:"#propertyFilter",alias:"Parcel_Type",message:"Select a Property Type"},{layer:_e,field:"Building_Type",filterSelector:"#buildingFilter",message:"Select a Building Type"},{layer:_e,field:"Building_Use_Code",filterSelector:"#buildingUseFilter",message:"Select a Building Use Type"},{layer:_e,field:"Design_Type",filterSelector:"#designTypeFilter",message:"Select a Design Type"},{layer:_e,field:"Zoning",filterSelector:"#zoningFilter",message:"Select a Zone"},{layer:_e,field:"Neighborhood",filterSelector:"#neighborhoodFilter",message:"Select a Neighborhood"}],he=[{layer:_e,field:"Appraised_Total",filterSelector:"#streetFilter",minInput:"app-val-min",maxInput:"app-val-max",minValField:"appraisedValueMin",maxValueField:"appraisedValueMax",index:0},{layer:_e,field:"Assessed_Total",filterSelector:"#ownerFilter",minInput:"assess-val-min",maxInput:"assess-val-max",minValField:"assessedValueMin",maxValueField:"assessedValueMax",index:1},{layer:_e,field:"Total_Acres",filterSelector:"#propertyFilter",minInput:"acres-val-min",maxInput:"acres-val-max",minValField:"acresValueMin",maxValueField:"acresValueMax",index:2},{layer:_e,field:"Sale_Date",filterSelector:"#buildingFilter",minInput:"sold_calendar_lowest",maxInput:"sold_calendar_highest",minValField:"soldOnMin",maxValueField:"soldOnMax",index:3},{layer:_e,field:"Sale_Price",filterSelector:"#buildingUseFilter",minInput:"saleP-val-min",maxInput:"saleP-val-max",minValField:"soldPMin",maxValueField:"soldPMax",index:4}],T.when((function(){let e;e="yes"===sessionStorage.getItem("condos")?"condoLayer":"noCondoLayer";var t=_.layers.find((t=>t.id===e));r.watch((()=>t.visible),(()=>{let e=t.visible;!function(e,t){let a=$(`calcite-list-item[value="${e}"] calcite-action`);if(t){if(a.hasClass("layer-vis"))return;a.attr("icon","check-square")}else{if(a.hasClass("layer-vis"))return;a.attr("icon","square")}}(t.id,e)}))})),$(document).ready((function(){$("body").on("click",".toggle-slider",(function(){$(this).closest("calcite-list-item").find(".opacity-div").toggle()}))})),$("#layerList").on("click",".layer-vis",(function(e){e.preventDefault(),function(e,t){let a=_.findLayerById(e);a&&(a.visible=!a.visible,"group"===a.type&&a.layers.forEach((e=>{e.visible=a.visible})),t.attr("icon",a.visible?"check-square":"square"))}($(this).closest("calcite-list-item").attr("value"),$(this))})),T.when((function(){var e=$("#layerList");Se(_.layers.items,e),$(".slider-opacity").on("calciteSliderChange",(function(e){const t=e.target.id;let a=_.findLayerById(t);var n=e.target.value/100;a.opacity=n}))}));let Ce,Pe,De,ke={appraisedValueMin:null,appraisedValueMax:null,assessedValueMin:null,assessedValueMax:null,acresValueMin:null,acresValueMax:null,soldOnMin:null,soldOnMax:null,soldPMin:null,soldPMax:null};function Ae(e,t,a){function n(){const n=pe.findIndex((t=>t.field==e));pe.splice(n,1),pe.forEach((n=>{!function(e,t,a,n,i,r,s){Be(a),$(a).empty();let l=Te.createQuery();if(Array.isArray(n)&&n.length>0&&!r){let e=n.map((e=>`${t} = '${e}'`));l.where=e.join(" OR ")}else l.where=n&&r?`${t} >= '${n}' AND ${t} <= '${r}'`:`${t} = '${n}'`;l.returnDistinctValues=!0,l.returnGeometry=!1,l.outFields=[i],i&&(l.orderByFields=[`${i} ASC`]);Te.queryFeatures(l).then((function(e){var t=e.features,n=$(a);n.empty(),t.forEach((function(e){var t=e.attributes[i];if(t&&t.trim()){var a=$(`<calcite-combobox-item value="${t}" text-label="${t}"></calcite-combobox-item>`);n.append(a)}})),Ee(a,s)}))}(n.layer,e,n.filterSelector,t,n.field,a,n.message)}))}clearTimeout(Ce),Ce=setTimeout((()=>{n()}),600)}async function Fe(e,t,a,n,i,r){try{let e=Te.createQuery();if(Array.isArray(n)&&n.length>0&&!r){let a=n.map((e=>`${t} = '${e}'`));e.where=a.join(" OR ")}else e.where=n&&r?`${t} BETWEEN '${n}' AND '${r}'`:`${t} = '${n}'`;e.returnDistinctValues=!0,e.returnGeometry=!1,e.outFields=[i],i&&(e.orderByFields=[`${i} ASC`]);let a=(await Te.queryFeatures(e)).features.map((e=>e.attributes[i])),s=Math.max(...a),l=Math.min(...a);switch(i){case"Sale_Date":let e=new Date(l),t=new Date(s),a=e.getFullYear(),n=("0"+(e.getMonth()+1)).slice(-2),i=("0"+e.getDate()).slice(-2),r=t.getFullYear(),o=("0"+(t.getMonth()+1)).slice(-2),d=("0"+t.getDate()).slice(-2),c=`${a}-${n}-${i}`,u=`${r}-${o}-${d}`;ke.soldOnMin=c,ke.soldOnMax=u;break;case"Appraised_Total":ke.appraisedValueMin=l,ke.appraisedValueMax=s;break;case"Assessed_Total":ke.assessedValueMin=l,ke.assessedValueMax=s;break;case"Sale_Price":ke.soldPMin=l,ke.soldPMax=s;break;case"Total_Acres":ke.acresValueMin=l,ke.acresValueMax=s;break;default:console.log("Sorry, no field found.")}clearTimeout(Pe),Pe=setTimeout((()=>{!function(e){const t=he.findIndex((t=>t.field==e));he.splice(t,1),he.forEach((e=>{const t=document.getElementById(e.minInput),a=document.getElementById(e.maxInput);let n=ke[e.minValField];const i=ke[e.maxValueField];let r,s;n===i&&(n=0),"Appraised_Total"===e.field||"Assessed_Total"===e.field||"Sale_Price"===e.field?(r="$"+(void 0!==n?n.toLocaleString():""),s="$"+(void 0!==i?i.toLocaleString():""),t.value=r,a.value=s):"Sale_Date"===e.field?(t.value=void 0!==n?n:"",a.value=void 0!==i?i:""):"Total_Acres"===e.field&&(r=void 0!==n?n.toLocaleString():"",s=void 0!==i?i.toLocaleString():"",t.value=r,a.value=s)}))}(t)}),600)}catch(e){console.error("Error querying features:",e)}}function Ne(e,t,a){const n=me.findIndex((t=>t.field==e));me.splice(n,1),async function(e,t,a,n){for(const i of e)await Fe(i.layer,t,i.filterSelector,a,i.field,n)}(me,e,t,a)}function Oe(e,t,a,n){Be(a),$(a).empty();let i=Te.createQuery();i.where=`1=1 AND ${t} IS NOT NULL`,i.returnDistinctValues=!0,i.returnGeometry=!1,t&&(i.orderByFields=[`${t} ASC`]),i.outFields=[t],i.maxRecordCountFactor=5,Te.queryFeatures(i).then((function(e){var n=e.features,i=(e.features.length,$(a));n.forEach((function(e){var a=e.attributes[t];if(a&&a.trim()){var n=$(`<calcite-combobox-item value="${a}" text-label="${a}"></calcite-combobox-item>`);i.append(n)}}))})),Ee(a,n)}function Re(){var e=document.querySelector(".esri-widget--button.esri-print__refresh-button.esri-icon-refresh");e&&e.click()}function Ue(e,t){const a=function(e,t){let a,n=t.split("?")[0],i=[],r=-1!==t.indexOf("?")?t.split("?")[1]:"";if(""!==r){i=r.split("&");for(let t=i.length-1;t>=0;t-=1)a=i[t].split("=")[0],a===e&&i.splice(t,1);n=n+"?"+i.join("&")}return n}("uniqueid",window.location.href);if(window.history.pushState({path:a},"",a),"no"===sessionStorage.getItem("condos")?xe.visible=!0:_e.visible=!0,R)try{R?.remove(),R=null}catch(e){console.error("Failed to remove DetailsHandle",e)}if(U)try{U?.remove(),U=null}catch(e){console.error("Failed to remove DetailsHandle",e)}ie="",Me(!!J),$("#select-button").removeClass("btn-warning"),$("#select-button").addClass("btn-warning"),U=T.on("click",We),J=!0,Q=!1,$("#searchInput ul").remove(),$("#searchInput").val="",$("#select-button").prop("disabled",!1);document.getElementById("searchInput").value="",S="",searchTerm="",H=[],secondList=[],oe="",L=!1,K=!1,G=!1,V=!1,$(".spinner-container").hide(),$("#distanceButton").removeClass("active"),$("#areaButton").removeClass("active"),$("#result-btns").hide(),$("#details-btns").hide(),$("#abut-mail").hide(),$("#dropdown").toggleClass("expanded"),$("#dropdown").hide(),$("#results-div").css("left","0px"),$("#sidebar2").css("left","-350px"),$("#sidebar2").removeClass("collapsed"),$("#right-arrow-2").show(),$("#left-arrow-2").hide(),$("#abutters-content").hide(),$("#selected-feature").empty(),$("#parcel-feature").empty(),$("#backButton").hide(),$("#exportResults").hide(),$("#csvExportResults").hide(),$("#csvExportSearch").hide(),$("#exportSearch").hide(),$("#total-results").hide(),$("#ResultDiv").hide(),$("#featureWid").hide(),$("#exportButtons").hide(),$("#layerListDiv").hide(),$("#detailBox").hide(),$("#filterDiv").hide(),$("#dropdown").show(),$("#WelcomeBox").show(),z=!1,$("#select-button").attr("title","Add to Selection Enabled"),$(".center-container").show(),document.getElementById("suggestions").innerHTML="",$("#distanceButton").removeClass("btn-warning"),$("#distanceButton").addClass("bg-info"),$("#areaButton").removeClass("btn-warning"),$("#distanceButton").addClass("bg-info"),$("#featureWid").empty(),T.ui.remove(be),be&&(be.destroy(),be=null),T.graphics.removeAll(),F=[]}function qe(e){D.sort(((t,a)=>"owner"===e?t.owner.toLowerCase().localeCompare(a.owner.toLowerCase()):"location"===e?t.location.toLowerCase().localeCompare(a.location.toLowerCase()):"Street_Name"===e?t.Street_name.toLowerCase().localeCompare(a.Street_name.toLowerCase()):void 0)),function(){let e,t;const a=document.getElementById("featureWid");a.innerHTML="";const n=document.createElement("ul");n.classList.add("row","list-group"),D.forEach((function(a){let i=a.objectid,r=a.location,s=void 0===a.uniqueId?a.GIS_LINK:a.uniqueId,l=a.GIS_LINK,o=a.coOwner,d=a.owner,c=a.MBL,u=a.geometry,p=a.Parcel_Type;"yes"===M.useUniqueIdforParcelMap?(t=s,e=s):(t=l,e=l);let m=a.Image_Path,h=void 0===a.AcctNum?"":a.AcctNum;const g=`${M.imageUrl}${m}`;n.classList.add("row"),n.classList.add("list-group");const f=document.createElement("li"),$=document.createElement("li"),y=document.createElement("tr");y.classList.add("col-12","list-group-item");let v,w,x=`<div class="extra-links">\n            <a target="_blank" class='pdf-links mx-2' rel="noopener noreferrer" href=https://publicweb-gis.s3.amazonaws.com/PDFs/${M.parcelMapUrl}/Quick_Maps/QM_${e}.pdf><span style="font-family:Tahoma;font-size:12px;"><strong>PDF Map</strong></a>`;"yes"==M.propertyCardPdf?x+=`<a target="_blank" class='pdf-links mx-2' rel="noopener noreferrer" href=${M.propertyCard}${s}.PDF><span style="font-family:Tahoma;font-size:12px;"><strong>Property Card</strong></a>`:x+=`<a target="_blank" class='pdf-links mx-2' rel="noopener noreferrer" href=${M.propertyCard}${s}><span style="font-family:Tahoma;font-size:12px;"><strong>Property Card</strong></a>`,"yes"===M.useVisionForTaxBillUrl?x+=`<a target="_blank" class='pdf-links mx-2' rel="noopener noreferrer" href=${M.tax_bill}&amp;uniqueId=${h}><span style="font-family:Tahoma;font-size:12px;"><strong>Tax Bills</strong></span></a>`:x+=`<a target="_blank" class='pdf-links mx-2' rel="noopener noreferrer" href=${M.tax_bill}&amp;uniqueId=${s}><span style="font-family:Tahoma;font-size:12px;"><strong>Tax Bills</strong></span></a>`,"yes"===M.includePermitLink&&(x+=`<a target="_blank" class='pdf-links mx-2' rel="noopener noreferrer" href=${M.permitLink}?uniqueid=${s} ><span style="font-family:Tahoma;font-size:12px;"><strong>Permits</strong></a>`),x+="</div>",y.innerHTML=x,$.innerHTML=`<img class="img-search image" object-id="${i}" src="${g}" alt="Image of ${s}" >`,f.classList.add("list-group-item","col-9"),f.classList.add("search-list"),$.setAttribute("object-id",i),$.setAttribute("data-id",l),$.classList.add("image-div","col-3"),w="yes"===sessionStorage.getItem(b),!o&&u||u?v=` <div class="listText">UID: ${s}  &nbsp;<br>MBL: ${c} <br> ${d} ${o} <br> ${r} <br> Property Type: ${p}</div>\n            <div class="justZoomBtn"><button type="button" class="btn btn-primary btn-sm justZoom" title="Zoom to Parcel"><calcite-icon icon="magnifying-glass-plus" scale="s"/>Zoom</button><button type="button" class="btn btn-primary btn-sm justRemove" title="Remove from Search List"><calcite-icon icon="minus-circle" scale="s"/>Remove</button></div>`:(v=` <div class="listText noGeometry">UID: ${s}  &nbsp;<br>MBL: ${c} <br> ${d} ${o} <br> ${r} <br> Property Type: ${p} \n             </div><div class="justZoomBtn"><button type="button" class="btn btn-primary btn-sm justRemove" title="Remove from Search List"><calcite-icon icon="minus-circle" scale="s"/>Remove</button></div>`,f.classList.add("no-zoomto")),f.innerHTML+=v,f.setAttribute("object-id",i),f.setAttribute("data-id",l),n.appendChild($),n.appendChild(f),n.appendChild(y)})),k=D.length,n.addEventListener("click",(function(e){if(e.target.closest(".justZoom")||e.target.closest(".justZoomBtn"))return;U&&(U?.remove(),U=null),R&&(R?.remove(),R=null),$("#select-button").attr("title","Select Enabled");let t=e.target.closest("li");if(!t)return;let a=t.getAttribute("data-id"),n=t.getAttribute("object-id");at(n,F,a),$("#details-spinner").show(),$("#WelcomeBox").hide(),$("#featureWid").hide(),$("#result-btns").hide(),$("#total-results").hide(),$("#ResultDiv").hide(),$("#abutters-content").hide(),$("#details-btns").show(),$("#abut-mail").show(),$("#detailBox").show(),$("#backButton").show(),$("#detailsButton").hide(),$("#detail-content").empty(),$("#selected-feature").empty(),$("#exportButtons").hide(),$("#exportSearch").hide(),$("#exportResults").hide(),$("#csvExportResults").hide(),$("#csvExportSearch").hide(),$("#results-div").css("height","300px"),$("#backButton-div").css("padding-top","0px"),$(".center-container").hide(),et(n,a)})),a.appendChild(n)}()}function Ve(e,t,a,n,i,r){$("status-loader").show(),$("#featureWid").empty();let s=new Set,l=new Set;D=H.filter((e=>!!e.geometry&&(s.add(e.uniqueId),!0))),H.forEach((e=>{!s.has(e.uniqueId)&&(l.add(e.uniqueId),D.push(e))})),D.sort(((e,t)=>{const a=e.owner?e.owner.toLowerCase():"",n=t.owner?t.owner.toLowerCase():"";return a.localeCompare(n)})),V||function(e){return H.filter((t=>t.objectid===e)).length}(n)>1&&function(e,t,a){"yes"==sessionStorage.getItem("condos")&&(D=D.filter((t=>t.objectid!=e)),H=H.filter((t=>t.objectid!=e)),$(`li[object-id="${e}"]`).remove()),"no"==sessionStorage.getItem("condos")&&(H=H.filter((e=>e.GIS_LINK!=a)),D=D.filter((e=>e.GIS_LINK!=a)),$(`li[data-id="${a}"]`).remove())}(n,0,r);const o=document.getElementById("featureWid"),d=document.createElement("ul");let c,u;D.forEach((function(e){let t=e.objectid,a=e.location,n=void 0===e.uniqueId?e.GIS_LINK:e.uniqueId,i=e.GIS_LINK,r=e.coOwner,s=e.owner,l=e.MBL,o=e.geometry,p=e.Parcel_Type;"yes"===M.useUniqueIdforParcelMap?(c=n,u=n):(c=i,u=i);let m=e.Image_Path,h=void 0===e.AcctNum?"":e.AcctNum;const g=`${M.imageUrl}${m}`;d.classList.add("row"),d.classList.add("list-group");const f=document.createElement("li"),$=document.createElement("li"),y=document.createElement("tr");y.classList.add("col-12","list-group-item");let v,w,x=`<div class="extra-links">\n            <a target="_blank" class='pdf-links mx-2' rel="noopener noreferrer" href=https://publicweb-gis.s3.amazonaws.com/PDFs/${M.parcelMapUrl}/Quick_Maps/QM_${u}.pdf><span style="font-family:Tahoma;font-size:12px;"><strong>PDF Map</strong></a>`;"yes"==M.propertyCardPdf?x+=`<a target="_blank" class='pdf-links mx-2' rel="noopener noreferrer" href=${M.propertyCard}${n}.PDF><span style="font-family:Tahoma;font-size:12px;"><strong>Property Card</strong></a>`:x+=`<a target="_blank" class='pdf-links mx-2' rel="noopener noreferrer" href=${M.propertyCard}${n}><span style="font-family:Tahoma;font-size:12px;"><strong>Property Card</strong></a>`,"yes"===M.useVisionForTaxBillUrl?x+=`<a target="_blank" class='pdf-links mx-2' rel="noopener noreferrer" href=${M.tax_bill}&amp;uniqueId=${h}><span style="font-family:Tahoma;font-size:12px;"><strong>Tax Bills</strong></span></a>`:x+=`<a target="_blank" class='pdf-links mx-2' rel="noopener noreferrer" href=${M.tax_bill}&amp;uniqueId=${n}><span style="font-family:Tahoma;font-size:12px;"><strong>Tax Bills</strong></span></a>`,"yes"===M.includePermitLink&&(x+=`<a target="_blank" class='pdf-links mx-2' rel="noopener noreferrer" href=${M.permitLink}?uniqueid=${n} ><span style="font-family:Tahoma;font-size:12px;"><strong>Permits</strong></a>`),x+="</div>",y.innerHTML=x,$.innerHTML=`<img class="img-search image" object-id="${t}" src="${g}" alt="Image of ${n}" >`,f.classList.add("list-group-item","col-9"),f.classList.add("search-list"),$.setAttribute("object-id",t),$.setAttribute("data-id",i),$.classList.add("image-div","col-3"),w="yes"===sessionStorage.getItem(b),!r&&o||o?v=` <div class="listText">UID: ${n}  &nbsp;<br>MBL: ${l} <br> ${s} ${r} <br> ${a} <br> Property Type: ${p}</div>\n            <div class="justZoomBtn"><button type="button" class="btn btn-primary btn-sm justZoom" title="Zoom to Parcel"><calcite-icon icon="magnifying-glass-plus" scale="s"/>Zoom</button><button type="button" class="btn btn-primary btn-sm justRemove" title="Remove from Search List"><calcite-icon icon="minus-circle" scale="s"/>Remove</button></div>`:(v=` <div class="listText noGeometry">UID: ${n}  &nbsp;<br>MBL: ${l} <br> ${s} ${r} <br> ${a} <br> Property Type: ${p} \n             </div><div class="justZoomBtn"><button type="button" class="btn btn-primary btn-sm justRemove" title="Remove from Search List"><calcite-icon icon="minus-circle" scale="s"/>Remove</button></div>`,f.classList.add("no-zoomto")),f.innerHTML+=v,f.setAttribute("object-id",t),f.setAttribute("data-id",i),d.appendChild($),d.appendChild(f),d.appendChild(y)})),k=D.length,$("#total-results").show(),$("#ResultDiv").show(),$("#total-results").html(k+" results returned"),$("#backButton").hide(),$("#detailsButton").hide(),$("#filterDiv").hide(),$("#layerListDiv").hide(),$("#result-btns").hide(),$("#details-btns").hide(),$("#abut-mail").hide(),$("#featureWid").show(),$("#detail-content").empty(),$("#dropdown").toggleClass("expanded"),$("status-loader").hide(),$("#dropdown").show(),$("#sidebar2").css("left","0px"),$("#sidebar2").addClass("collapsed"),$("#results-div").css("left","350px"),$("#left-arrow-2").show(),$("#right-arrow-2").hide(),$("#WelcomeBox").hide(),$("#csvExportResults").hide(),$("#exportSearch").show(),$("#results-div").css("height","300px"),$("#exportButtons").show(),$("#exportResults").hide(),$("#csvExportSearch").show(),$(".spinner-container").hide(),$(`li[object-id="${n}"]`).remove(),V=!1,d.addEventListener("click",(function(e){let a=!0;if(e.target.closest(".justZoom")||e.target.closest(".justZoomBtn")||e.target.closest(".pdf-links"))return;U&&(U?.remove(),U=null),R&&(R?.remove(),R=null),$("#select-button").attr("title","Select Enabled");let n=e.target.closest("li");if(!n)return;let i=n.getAttribute("data-id"),r=n.getAttribute("object-id");at(r,t,i),$("#details-spinner").show(),$("#WelcomeBox").hide(),$("#featureWid").hide(),$("#result-btns").hide(),$("#total-results").hide(),$("#ResultDiv").hide(),$("#abutters-content").hide(),$("#details-btns").show(),$("#abut-mail").show(),$("#detailBox").show(),$("#backButton").show(),$("#detailsButton").hide(),$("#detail-content").empty(),$("#selected-feature").empty(),$("#exportButtons").hide(),$("#exportSearch").hide(),$("#exportResults").hide(),$("#csvExportResults").hide(),$("#csvExportSearch").hide(),$("#results-div").css("height","300px"),$("#backButton-div").css("padding-top","0px"),$(".center-container").hide(),$("#abutters-attributes").prop("disabled",!1),$("#abutters-zoom").prop("disabled",!1),e.target.closest(".no-zoomto")&&(console.log("dont zoom"),a=!1),et(r,i,a)})),o.appendChild(d),K=!1}function ze(e,t,a,n){let i,r,s;function l(e){e.forEach((function(e){if(""!==e.attributes.Owner){let t=e.attributes.OBJECTID,a=e.attributes.Location,n=e.attributes.Uniqueid,i=e.attributes.GIS_LINK,r=e.attributes.Co_Owner,s=e.attributes.Owner,l=e.attributes.MBL,o=e.geometry,d=e.attributes.Mailing_Address_1,c=e.attributes.Mailing_Address_2,u=e.attributes.Mailing_City,p=e.attributes.Mail_State,m=e.attributes.Mailing_Zip,h=e.attributes.Total_Acres,g=e.attributes.Parcel_Primary_Use,f=e.attributes.Building_Use_Code,$=e.attributes.Parcel_Type,b=e.attributes.Design_Type,v=e.attributes.Zoning,w=e.attributes.Neighborhood,x=e.attributes.Land_Type_Rate,_=e.attributes.Functional_Obs,T=e.attributes.External_Obs,I=y(e.attributes.Sale_Date),L=e.attributes.Sale_Price,S=e.attributes.Vol_Page,M=e.attributes.Assessed_Total,B=e.attributes.Appraised_Total,E=e.attributes.Influence_Factor,C=e.attributes.Influence_Type,P=e.attributes.Land_Type,D=e.attributes.Prior_Assessment_Year,k=e.attributes.Prior_Assessed_Total,A=e.attributes.Prior_Appraised_Total,F=e.attributes.Map,N=e.attributes.Lat,O=e.attributes.Lon,R=e.attributes.Image_Path,U=e.attributes.AcctNum,q=e.attributes.Match_Status;H.push(new je(t,a,n,i,r,s,l,o,d,c,u,p,m,h,g,f,$,b,v,w,x,_,T,I,L,S,M,B,E,C,P,D,k,A,F,N,O,R,U,q))}}))}if(a&&null!=a){i=e[0].attributes.OBJECTID,r=e[0].attributes.Location,s=e[0].attributes.GIS_LINK;const a=H.filter((e=>e.objectid===i)).length,n=H.filter((e=>e.GIS_LINK===s)).length;a>=1||0==a&&n>=1?(l(e),Ve(0,t,0,i,0,s)):(l(e),Ve())}else e?e.length>1?(Q||(e=e.filter((e=>"CONDOMAIN"!=e.attributes.ACCOUNT_TYPE))),l(e)):l(e):Ve(0,t,0,i);a||Ve(0,t,0,i,0,s)}function Ge(e,t,a,n){let i,r;De=n?e:e.features,w.removeAll();let l,o,d=[];var c={type:"simple-fill",color:[127,42,145,.4],outline:{color:[127,42,145,.8],width:2}};if(a){l=e.features[0].attributes.OBJECTID,o=De[0].attributes.GIS_LINK;const a=new s({geometry:De[0].geometry,symbol:c,id:l});if(d.push(a),r=H.filter((e=>e.GIS_LINK===o)).length,i=T.graphics.some((e=>e.id===l)),i){const e=T.graphics.findIndex((e=>e.id===l));T.graphics.removeAt(e);const t=F.findIndex((e=>e.id===l));1===F.length?F.splice(0,1):F.splice(t,1),0===F.length&&(R||(R=T.on("click",Ze)),U&&(U?.remove(),U=null),U=T.on("click",We))}else t.addMany(d)}else if(n){De.filter((e=>e.geometry)).forEach((e=>{const t=e.attributes.OBJECTID,a=new s({geometry:e.geometry,symbol:c,id:t});d.push(a)})),d.length>=1&&t.addMany(d),T.goTo({target:F,zoom:18})}else{let e;if(ee=!0,De.map((function(t){if(l=t.attributes.OBJECTID,!t.geometry||n)return null;e=new s({geometry:t.geometry,symbol:c,id:l}),d.push(e)})).filter((e=>null!==e)),1==d.length){t.addMany(d);const e=De[0].geometry.extent,a=(e.center,2),n=e.expand(a);T.goTo({target:d,extent:n})}else if(t.addMany(d),d.length>0){const e=d.map((e=>e.geometry.extent)),t=3,a=e.reduce(((e,t)=>e.union(t)),e[0]).expand(t);T.goTo({target:a}).catch((e=>{console.error("Error zooming to extent:",e)}))}else console.warn("No graphics available to calculate extent.")}if(F||(F=d),a&&!i){let e=d[0].id;F=[...F,d[0]],q=e}ee&&(F=d),i=!1,ee=!1}Oe(0,"Street_Name","#streetFilter","Select a Street Name"),Oe(0,"Owner","#ownerFilter","Select a Owner"),Oe(0,"Parcel_Type","#propertyFilter","Select a Property Type"),Oe(0,"Building_Type","#buildingFilter","Select a Building Type"),Oe(0,"Building_Use_Code","#buildingUseFilter","Select a Building Use"),Oe(0,"Design_Type","#designTypeFilter","Select a Design Type"),Oe(0,"Zoning","#zoningFilter","Select a Zone"),Oe(0,"Neighborhood","#neighborhoodFilter","Select a Neighborhood"),document.getElementById("Print-selector").addEventListener("click",(function(){!function(){const e=600,t=8,a=t*e,n=8*e;T.takeScreenshot({width:a,height:n}).then((function(e){const a=window.open("","_blank"),n=document.getElementById("scale-value").innerHTML,i=(new Date).toLocaleString();a.document.write(`\n            <!DOCTYPE html>\n            <html lang="en">\n            <head>\n                <meta charset="UTF-8">\n                <meta name="viewport" content="width=device-width, initial-scale=1.0">\n                <title>Print Map</title>\n                <link rel="stylesheet" href="https://js.arcgis.com/4.27/esri/themes/light/main.css">\n                <style>\n                    body {\n                        display: flex;\n                        flex-direction: column;\n                        align-items: center;\n                        justify-content: center;\n                        margin: 0;\n                        padding: 0;\n                    }\n                    .print-title {\n                        display: flex;\n                        align-items: center;\n                        justify-content: center;\n                        text-align: center;\n                        font-size: 22px;\n                    }\n                    .print-scale {\n                        display: flex;\n                        align-items: center;\n                        justify-content: space-around;\n                        text-align: center;\n                        font-size: 14px;\n                        width: 100%;\n                        margin-left: 20px;\n                        margin-right: 20px;\n                    }\n                    .print-title img {\n                        margin-right: 20px;\n                    }\n                    .scale-bar-container {\n                        margin-right: 50px;\n                    }\n                    .print-scale-bar {\n                        width: 300px;\n                        height: 30px;\n                    }\n                    .info-writing-container {\n                        display: flex;\n                        justify-content: center;\n                        align-items: flex-start;\n                        width: 80%;\n                        margin: 20px auto;\n                    }\n                    .info-text {\n                        width: 20%;\n                        text-align: left;\n                        margin-right: 20px;\n                    }\n                    .writing-lines {\n                        width: 80%;\n                        text-align: center;\n                    }\n                    .writing-lines div {\n                        border-bottom: 1px solid black;\n                        margin: 10px 0;\n                        height: 20px;\n                    }\n                    @media print {\n                        body * {\n                            visibility: visible;\n                        }\n                    }\n                </style>\n            </head>\n            <body>\n                <div class="print-title" id="print-title">\n                    <img id="town-logo" src="${M.welcomeImage}" alt="Town Logo">\n                    <h1 id="title-text">${M.title}</h1>\n                </div>\n                <div class="print-map">\n                    <img id="print-map-image" src="${e.dataUrl}" alt="Map Image" style="width: ${t}in; border: 3px solid #A9A9A9; margin: 0 0.75in;">\n                </div>\n                <div class="print-scale">\n                    <div class="print-date" style="font-size: 12px;">Date Printed: ${i}</div>\n                    <div id="to-scale" class="scale-bar-container"></div>\n                        <div id="print-scale-bar" class="scale-bar-container">${n} (approx)</div>\n                </div>\n                <div style="text-align: center; font-size: 12px; padding-left: 30px; padding-right: 30px;">\n                    <p>Disclaimer: This map is intended for reference and general informational purposes\n                    only and is not a legally recorded map or survey. While reasonable effort has been\n                    made to ensure the accuracy, correctness, and timeliness of materials presented,\n                    the map vendor and the municipality disclaim any and all liability and responsibility for\n                    any errors, omissions, or inaccuracies in the data provided, including without limitation\n                    any liability for direct, indirect, incidental, consequential, special, exemplary,\n                    punitive, or any other type of damages. Users are hereby notified that the primary\n                    information source should be consulted for verification of the data contained herein.\n                    Continued use of this map acknowledges acceptance of these terms.</p>\n                </div>\n                <script>\n                    window.onload = function() {\n                        window.print();\n                    };\n                <\/script>\n            </body>\n            </html>\n          `),a.document.close()}))}()})),T.watch("zoom",(function(e,t){e!==t&&Re()})),T.watch("center",(function(e,t){e!==t&&Re()})),$(document).ready((function(){$(document).on("click",".justRemove",(function(e){e.stopPropagation(),e.preventDefault();let t=e.target.closest("li"),a=t.getAttribute("data-id"),n=t.getAttribute("object-id"),i=e,r=!0,s=[],l=!1,o=t.querySelector(".listText");if(o){let e=o.classList;s=Array.from(e),l=s.includes("noGeometry")}if("no"===sessionStorage.getItem("condos")){let e=_e.createQuery();e.where=l?`GIS_LINK = '${a}'`:`OBJECTID = '${n}'`,e.returnGeometry=!0,e.outFields=["*"],xe.queryFeatures(e).then((function(e){totalResults=e.features,ze(totalResults,"",i),Ge(e,T.graphics,r)}))}else{let e=_e.createQuery();e.where=`OBJECTID = ${n}`,e.returnGeometry=!0,e.outFields=["*"],_e.queryFeatures(e).then((function(e){totalResults=e.features,ze(totalResults,"",i),Ge(e,T.graphics,r)}))}}))})),$(document).ready((function(){$(document).on("click",".justZoom",(function(e){e.stopPropagation(),e.preventDefault();let t=e.target.closest("li"),a=(t.getAttribute("data-id"),t.getAttribute("object-id"));if("no"===sessionStorage.getItem("condos")){let e=`OBJECTID = ${a}`,t=xe.createQuery();t.where=e,t.returnGeometry=!0,t.returnHiddenFields=!0,t.outFields=["*"],xe.queryFeatures(t).then((e=>{let t=e.features[0].geometry;const a=t.extent;a.center,a.expand(3);T.goTo({target:t})}))}else{let e=`OBJECTID = ${a}`,t=_e.createQuery();t.where=e,t.returnGeometry=!0,t.returnHiddenFields=!0,t.outFields=["*"],_e.queryFeatures(t).then((e=>{let t=e.features[0].geometry;const a=t.extent;a.center,a.expand(3);T.goTo({target:t})}))}}))})),document.getElementById("sortByOwner").addEventListener("click",(function(){qe("owner")})),document.getElementById("sortByLocation").addEventListener("click",(function(){qe("location")}));let Ke=new d({view:T,layer:w,defaultCreateOptions:{mode:"freehand"},polygonSymbol:{type:"simple-fill",style:"cross",color:"rgb(145, 199, 61)",outline:{width:3,style:"solid",color:"rgba(127, 42, 145, 1)"}},defaultUpdateOptions:{tool:"reshape",toggleToolOnClick:!1}});$("#lasso").on("click",(function(e){Q=!Q,J=!1,$("#select-button").removeClass("btn-warning"),$("#select-button").prop("disabled",!1),Q&&!J?(Ke.create("polygon"),$("#select-button").removeClass("btn-warning"),$("#lasso").addClass("btn-warning")):(Ke.cancel(),$("#lasso").removeClass("btn-warning"),$("#lasso").addClass("btn-info"),$("#select-button").removeClass("btn-warning"),$("#select-button").addClass("btn-info")),Ue(),w.removeAll(),"no"===sessionStorage.getItem("condos")?xe.visible=!0:_e.visible=!0})),Ke.on("create",(function(e){"complete"===e.state&&(w.remove(e.graphic),w.add(e.graphic),function(e){let t=!0;K=!0;let a=[];"no"==sessionStorage.getItem("condos")?function(){let n=xe.createQuery();n.geometry=e,n.distance=1,n.units="feet",n.spatialRelationship="intersects",n.returnGeometry=!0,n.outFields=["*"],xe.queryFeatures(n).then((function(n){n.features.forEach((e=>{a.push(e.attributes.GIS_LINK)})),Je(a,t),e=!1}))}():function(){let n=_e.createQuery();n.geometry=e,n.distance=1,n.units="feet",n.spatialRelationship="intersects",n.returnGeometry=!0,n.outFields=["*"],_e.queryFeatures(n).then((function(n){n.features.forEach((e=>{a.push(e.attributes.GIS_LINK)})),Je(a,t),e=!1}))}()}(e.graphic.geometry),R&&(R?.remove(),R=null),U&&(U?.remove(),U=null),$("#lasso").removeClass("btn-warning"),$("#lasso").addClass("btn-info"))})),$("#select-button").on("click",(function(e){if(Ke.cancel(),J=!!de||!J,J||Ue(),Q=!1,J&&!Q?($("#lasso").removeClass("btn-warning"),$("#select-button").addClass("btn-warning")):$("#select-button").removeClass("btn-warning"),"no"===sessionStorage.getItem("condos")?xe.visible=!0:_e.visible=!0,J&&!Q){if(U)try{U?.remove(),U=null}catch(e){console.error("Failed to remove clickHandle",e)}if(R)try{R?.remove(),R=null}catch(e){console.error("Failed to remove DetailsHandle",e)}U=T.on("click",We)}else if(J&&Q)R&&(R?.remove(),R=null),U&&(U?.remove(),U=null),U=T.on("click",We);else{if(U)try{U?.remove(),U=null}catch(e){console.error("Failed to remove clickHandle",e)}if(R)try{R?.remove(),R=null}catch(e){console.error("Failed to remove DetailsHandle",e)}}})),$("#home").on("click",(function(e){T.goTo(M.homeExtent)}));class je{constructor(e,t,a,n,i,r,s,l,o,d,c,u,p,m,h,g,f,$,y,b,v,w,x,_,T,I,L,S,M,B,E,C,P,D,k,A,F,N,O,R){this.objectid=e,this.location=t,this.uniqueId=a,this.GIS_LINK=n,this.coOwner=i,this.owner=r,this.MBL=s,this.geometry=l,this.mailingAddress=o,this.mailingAddress2=d,this.Mailing_City=c,this.Mail_State=u,this.Mailing_Zip=p,this.Total_Acres=m,this.Parcel_Primary_Use=h,this.Building_Use_Code=g,this.Parcel_Type=f,this.Design_Type=$,this.Zoning=y,this.Neighborhood=b,this.Land_Type_Rate=v,this.Functional_Obs=w,this.External_Obs=x,this.Sale_Date=_,this.Sale_Price=T,this.Vol_Page=I,this.Assessed_Total=L,this.Appraised_Total=S,this.Influence_Factor=M,this.Influence_Type=B,this.Land_Type=E,this.Prior_Assessment_Year=C,this.Prior_Assessed_Total=P,this.Prior_Appraised_Total=D,this.Map=k,this.LAT=A,this.LON=F,this.Image_Path=N,this.AcctNum=O,this.Match_Status=R}}function He(){$("#results-div").css("height","300px"),$("#backButton-div").css("padding-top","0px"),$(".center-container").hide(),$("#layerListDiv").hide(),$("#details-spinner").hide(),$("#featureWid").hide(),$("#result-btns").hide(),$("#total-results").hide(),$("#ResultDiv").hide(),$("#abutters-content").hide(),$("#details-btns").show(),$("#abut-mail").show(),$("#detailBox").show(),$("#backButton").show(),$("#detailsButton").hide(),$("#detail-content").html('<h5 style="color: red;">Issue selecting Parcel. Please make another selection.</h5>'),$("#abutters-attributes").prop("disabled",!0),$("#abutters-zoom").prop("disabled",!0),$("#selected-feature").empty(),$("#exportSearch").hide(),$("#exportButtons").hide()}function Ze(e){if(U&&(U?.remove(),U=null),$("#details-spinner").show(),$("#featureWid").hide(),$("#result-btns").hide(),$("#total-results").hide(),$("#ResultDiv").hide(),$("#abutters-content").hide(),$("#details-btns").show(),$("#abut-mail").show(),$("#detailBox").show(),$("#backButton").show(),$("#detailsButton").hide(),$("#detail-content").empty(),$("#selected-feature").empty(),$("#exportSearch").hide(),$("#exportButtons").hide(),$("#results-div").css("height","300px"),$("#backButton-div").css("padding-top","0px"),$("#abutters-attributes").prop("disabled",!1),$("#abutters-zoom").prop("disabled",!1),"no"===sessionStorage.getItem("condos")){let t=xe.createQuery();t.geometry=e.mapPoint,t.spatialRelationship="intersects",t.returnGeometry=!0,t.outFields=["*"],xe.queryFeatures(t).then((function(e){if(totalResults=e.features,totalResults.length>0){tt(e.features[0].attributes.OBJECTID,e.features[0].geometry,e.features[0]),Xe(totalResults)}else He()}))}else{let t=_e.createQuery();t.geometry=e.mapPoint,t.spatialRelationship="intersects",t.returnGeometry=!0,t.outFields=["*"],_e.queryFeatures(t).then((function(e){if(totalResults=e.features,totalResults.length>0){tt(e.features[0].attributes.OBJECTID,e.features[0].geometry,e.features[0]),Xe(totalResults)}else He()}))}}function We(e){if(re="click",V=!1,Y=!0,R&&(R?.remove(),R=null),"no"===sessionStorage.getItem("condos")){let t=xe.createQuery();t.geometry=e.mapPoint,t.spatialRelationship="intersects",t.returnGeometry=!0,t.outFields=["*"],xe.queryFeatures(t).then((function(t){t.features&&(totalResults=t.features,ze(totalResults,"",e),Ge(t,T.graphics,Y))}))}else{let t=_e.createQuery();t.geometry=e.mapPoint,t.spatialRelationship="intersects",t.returnGeometry=!0,t.outFields=["*"],_e.queryFeatures(t).then((function(t){t.features&&(totalResults=t.features,ze(totalResults,"",e),Ge(t,T.graphics,Y))}))}}function Qe(e){var t;t="search"===e?document.querySelectorAll(".export-search-list"):document.querySelectorAll(".abutters-group-list");const a=[];document.querySelectorAll(".search-list").forEach((function(e,t){a[t]=e.innerHTML}));var n="<ul class='label-list'>";t.forEach((function(e){n+="<li>"+e.innerHTML.trim()+"</li>"})),n+="</ul>";var i=window.open("","print","left=0,top=0,width=800,height=600,toolbar=0,status=0");i.document.write("<!DOCTYPE html><html><head>"),i.document.write("<title>Print Labels</title>"),i.document.write("<style>body { margin: 0; padding: 0; font-size: 10pt; }.label-list { list-style-type: none; margin: 0; padding: 0; display: flex; align-items: center; text-align: center; flex-wrap: wrap; justify-content: space-between; }.label-list li { box-sizing: border-box; width: 2.225in; height: 1in; margin-bottom: 0.0in; padding: 0.1in; display: flex; align-items: center; justify-content: center; font-size: 8pt; }@media print {  body { margin: 0.0in 0.1875in; }  .label-list { padding: 0; }  .label-list li { margin-right: 0in; margin-bottom: 0; }  @page { margin-top: 0.5in; margin-bottom: 0.5in; margin-left: 0.25in; margin-right: 0.25in }}</style>"),i.document.write("</head><body>"),i.document.write(n),i.document.write("</body></html>"),i.document.close(),setTimeout((()=>{i.print(),i.close(),document.querySelectorAll(".search-list").forEach((function(e,t){a[t]&&(e.innerHTML=a[t])}))}),250)}function Je(e,t){if(e.length>0){let a=[];e.forEach((e=>{a.includes(e)||a.push(e)}));const n=a.map((e=>`'${e}'`)).join(" OR GIS_LINK = "),i=`GIS_LINK = ${n}`;let r=Te.createQuery();r.where=i,r.returnGeometry=!1,r.returnHiddenFields=!0,r.outFields=["*"],Te.queryFeatures(r).then((e=>{t?it("","",r):function(e){const t=document.getElementById("parcel-feature");t.innerHTML="";const a=e.features;totalResults=a.length,lastResults=totalResults,P=a,D=a,se=a,a.forEach((function(e){let a=e.attributes.GIS_LINK,n=e.attributes.OBJECTID,i=e.attributes.Owner,r=e.attributes.Co_Owner,s=e.attributes.Mailing_Address_1,l=e.attributes.Mailing_Address_2,o=e.attributes.Mailing_City,d=e.attributes.Mail_State,c=e.attributes.Mailing_Zip;const u=document.createElement("ul");u.classList.add("row"),u.classList.add("list-group"),u.classList.add("abutters-list");const p=document.createElement("li");p.classList.add("abutters-group-item","col-12");let m="";m=` ${i} ${r} <br> ${s} ${l} <br> ${o}, ${d} ${c}`,p.innerHTML+=m,p.setAttribute("data-id",a),p.setAttribute("object-id",n),u.appendChild(p),t.appendChild(u),$("#abutters-spinner").hide(),$("#abutters-title").html(`Abutting Parcels (${totalResults})`)})),$("#results-div").css("height","300px"),$("#exportResults").show(),$("#csvExportResults").show()}(e)}))}else console.log("No buffer results to query.")}function Ye(e){$("#abutters-spinner").show(),0===e&&(e=-10);let t,a=e,n=W;t=(sessionStorage.getItem("condos"),l.geodesicBuffer(E,a,n)),function(e){A="BufferGraphicId";const t=T.graphics.items.findIndex((e=>e.id===A));t>-1&&T.graphics.removeAt(t);let a=new s({geometry:e,symbol:{type:"simple-fill",color:[51,51,204,.1],style:"forward-diagonal",outline:{color:"rgba(127, 42, 145, 0.8)",width:4}},id:A});T.graphics.add(a),T.goTo({target:a})}(t),function(e){const t={spatialRelationship:"intersects",geometry:e,outFields:["*"],returnGeometry:!0,units:W};let a=[];"no"===sessionStorage.getItem("condos")?xe.queryFeatures(t).then((e=>{e.features.forEach((e=>{a.push(e.attributes.GIS_LINK)})),Je(a)})):_e.queryFeatures(t).then((e=>{e.features.forEach((e=>{a.push(e.attributes.GIS_LINK)})),Je(a)}))}(t)}function Xe(e){function t(e){return void 0===e?"":new Intl.NumberFormat("en-US").format(e)}$("#select-button").prop("disabled",!0),$("#select-button").removeClass("btn-warning"),re="detailClick",$("#detail-content").empty(),$("#selected-feature").empty(),$(".center-container").hide(),$("#layerListDiv").hide();let a,n,i=e[0].attributes,r=void 0===i.Location?"":i.Location,s=void 0===i.Uniqueid?"":i.Uniqueid,l=void 0===i.GIS_LINK?"":i.GIS_LINK,o=void 0===i.Co_Owner?"":i.Co_Owner,d=void 0===i.Owner?"":i.Owner,c=void 0===i.MBL?"":i.MBL,u=void 0===i.Mailing_Address_1?"":i.Mailing_Address_1,p=void 0===i.Mailing_City?"":i.Mailing_City+", ",m=void 0===i.Mail_State?"":i.Mail_State,h=void 0===i.Mailing_Zip?"":i.Mailing_Zip,g=void 0===i.Total_Acres?"":i.Total_Acres,f=void 0===i.Parcel_Primary_Use?"":i.Parcel_Primary_Use,b=void 0===i.Building_Use_Code?"":i.Building_Use_Code,v=i.Sale_Date,w=void 0===i.Sale_Date?"":y(v),x=void 0===i.Sale_Price?"":t(i.Assessed_Total),_=void 0===i.Vol_Page?"":i.Vol_Page,T=void 0===i.Prior_Appraised_Total?"":t(i.Prior_Appraised_Total),L=void 0===i.Prior_Assessed_Total?"":t(i.Prior_Assessed_Total),S=void 0===i.Prior_Assessment_Year?"":i.Prior_Assessment_Year,B=void 0===i.Map?"":$.trim(i.Map),E=void 0===i.OBJECTID?"":i.OBJECTID,C=void 0===i.Lat?"":i.Lat,P=void 0===i.Lon?"":i.Lon,D=void 0===i.AcctNum?"":i.AcctNum;"yes"===M.useUniqueIdforParcelMap?(le=s,a=s):(le=l,a=l),n="yes"===M.useVisionForTaxBillUrl?D:s,oe=E,I=l;const k=i.Image_Path,A=document.getElementById("detail-content"),F=document.createElement("div");F.innerHTML="",F.classList.add("details");let N=M.DetailLinksToInclude,O=M.DetailLinks,R=[];O.forEach((e=>{let t=e;if(N.includes(e)){let e={[t]:{show:"show"}};R.push(e)}else{let e={[t]:{show:"none"}};R.push(e)}}));let U=`\n        <p>\n        <span style="font-family:Tahoma;font-size:14px;"><strong>${r}</strong></span> <br>\n        </p>\n  \n        <div>\n        <img class="image" src=${M.imageUrl}${k} alt="Building Photo" width="250" height="125">\n        </div>\n        <p>\n        <span style="font-family:Tahoma;font-size:12px;"><strong>${d} ${o}</strong></span> <br>\n        <span style="font-family:Tahoma;font-size:12px;"><strong>${u}</strong></span> <br>\n        <span style="font-family:Tahoma;font-size:12px;"><strong>${p} ${m} ${h}</strong></span><br>\n    </p>\n    <div id="accordion">\n      <div class="card" id="links" style="display:${R[0].links.show}">\n        <div class="card-header" id="headingOne">\n            <h5 class="mb-0">\n            <button class="btn btn-link collapsed" style="width: fit-content;" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">\n                Property Links\n            </button>\n          </h5>\n      </div>\n  \n      \n      <div id="collapseOne" class="collapse show" aria-labelledby="OneFour" data-parent="#accordion">\n             <div class="card-body" style="text-align: left;">\n      `;"yes"===M.includePermitLink&&(U+=`<a class='mx-auto' href=${M.permitLink}?uniqueid=${n} target="_blank"><span style="font-family:Tahoma;font-size:12px;"><strong>Permits</strong></a><br>`),U+=`\n        <table style="width: 100%; font-family: Tahoma; font-size: 12px; border-collapse: collapse; text-align: left;">\n          <tr>\n            <td>\n              <a target="_blank" rel="noopener noreferrer" href="${M.tax_bill}&uniqueId=${n}">\n                <strong>Tax Bills</strong>\n              </a>\n            </td>\n            <td>`,"yes"==M.propertyCardPdf?U+=`<a target="_blank" rel="noopener noreferrer" href="${M.propertyCard}${s}.PDF"><strong>Property Card</strong></a>`:U+=`<a target="_blank" rel="noopener noreferrer" href="${M.propertyCard}${s}"><strong>Property Card</strong></a>`,U+=`</td>\n        </tr>\n        <tr>\n          <td>\n            <a target="_blank" rel="noopener noreferrer" href="https://publicweb-gis.s3.amazonaws.com/PDFs/${M.parcelMapUrl}/Quick_Maps/QM_${a}.pdf">\n              <strong>Parcel Map</strong>\n            </a>\n          </td>\n          <td>\n            <a target="_blank" rel="noopener noreferrer" href="${M.taxMap_Url}${B}.pdf">\n              <strong>Tax Map</strong>\n            </a>\n          </td>\n        </tr>\n        <tr>\n          <td>\n            <a target="_blank" rel="noopener noreferrer" href="https://www.google.com/maps/@${C},${P},17z/@${C},${P},17z/data=!5m1!1e2">\n              <strong>Google Maps</strong>\n            </a>\n          </td>\n          <td>\n            <a target="_blank" rel="noopener noreferrer" href="https://www.bing.com/maps?cp=${C}~${P}&lvl=17.0">\n              <strong>Bing Maps</strong>\n            </a>\n          </td>\n        </tr>\n        <tr><td colspan="2"> &nbsp </td></tr>\n        <tr>\n          <td colspan="2">\n            <a target="_blank" rel="noopener noreferrer" href="${M.pdf_demo}">\n              <strong>Demographics Profile</strong>\n            </a>\n          </td>\n        </tr>\n        <tr>\n          <td colspan="2">\n            <a target="_blank" rel="noopener noreferrer" href="${M.housingUrl}">\n              <strong>Housing Profile</strong>\n            </a>\n          </td>\n        </tr>\n      </table>\n      </div>\n      </div>\n      </div>\n          <div class="card " id="ids" style="display:${R[1].ids.show}">\n              <div class="card-header" id="headingTwo">\n              <h5 class="mb-0">\n                  <button class="btn btn-link collapsed" style="width: fit-content;" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">\n                  Property Ids & Uses\n                  </button>\n              </h5>\n              </div>\n              <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">\n                  <div class="card-body">\n                    <p>\n                    <span style="font-family:Tahoma;font-size:12px;">Unique ID: <strong>${s}</strong></span> <br>\n                    <span style="font-family:Tahoma;font-size:12px;">MBL: <strong>${c}</strong></span> <br>\n                    <span style="font-family:Tahoma;font-size:12px;">Total Acres: <strong>${g}</strong></span> <br>\n                    <span style="font-family:Tahoma;font-size:12px;">Primary Use: <strong>${f}</strong></span> <br>\n                    <span style="font-family:Tahoma;font-size:12px;">Primary Bldg Use: <strong>${b}</strong></span><br>\n                    </p>\n                  </div>\n              </div>\n          </div>\n      <div class="card" id="sales" style="display:${R[3].sales.show}" >\n      <div class="card-header" id="headingThree">\n        <h5 class="mb-0">\n          <button class="btn btn-link collapsed" style="width: fit-content;" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">\n            Latest Sale / Transfer\n          </button>\n        </h5>\n      </div>\n      <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">\n        <div class="card-body">\n          <p>\n          <span style="font-family:Tahoma;font-size:12px;">Sold on: <strong>${w}</strong></span> <br>\n          <span style="font-family:Tahoma;font-size:12px;">Sale Price: <strong>$${x}</strong></span> <br>\n          <span style="font-family:Tahoma;font-size:12px;">Volume/Page: <strong>${_}</strong></span><br>\n          </p>\n        </div>\n      </div>\n    </div>\n    <div class="card" id="vals" style="display:${R[2].vals.show}">\n      <div class="card-header" id="headingFour">\n          <h5 class="mb-0">\n            <button class="btn btn-link collapsed" style="width: fit-content;" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">\n              Valuations\n            </button>\n          </h5>\n        </div>\n        <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordion">\n          <div class="card-body">\n              <p>\n              <span style="font-family:Tahoma;font-size:12px;"><strong>Valuations:</strong></span><br>\n              <span style="font-family:Tahoma;font-size:12px;">GL Year: <strong>${S}</strong></span> <br>\n              <span style="font-family:Tahoma;font-size:12px;">Assessment: <strong>$${L}</strong></span> <br>\n              <span style="font-family:Tahoma;font-size:12px;">Appraised: <strong>$${T}</strong></span> <br>\n              <span style="font-family:Tahoma;font-size:12px;"></span>\n              </p>\n          </div>\n      </div>\n    </div>\n  </div>\n      `,F.innerHTML=U,$("#details-spinner").hide(),A.appendChild(F)}function et(e,t,a){function n(e){return void 0===e?"":new Intl.NumberFormat("en-US").format(e)}var i;a?$("#abutters-zoom").prop("disabled",!1):$("#abutters-zoom").prop("disabled",!0),$("#select-button").prop("disabled",!0),$("#select-button").removeClass("btn-warning"),U&&(U?.remove(),U=null),re="detailClick",$("#exportResults").hide(),$("#csvExportResults").hide(),j=[e,t],(i=H.find((function(a){return a.objectid===parseInt(e)&&a.GIS_LINK===t})))||(i=H.find((function(e){return e.GIS_LINK===t||e.uniqueId===t})));let r,s,l=void 0===i.location?"":i.location,o=void 0===i.uniqueId?"":i.uniqueId,d=void 0===i.GIS_LINK?"":i.GIS_LINK,c=void 0===i.coOwner?"":i.coOwner,u=void 0===i.owner?"":i.owner,p=void 0===i.MBL?"":i.MBL,m=void 0===i.mailingAddress?"":i.mailingAddress,h=void 0===i.Mailing_City?"":i.Mailing_City+", ",g=void 0===i.Mail_State?"":i.Mail_State,f=void 0===i.Mailing_Zip?"":i.Mailing_Zip,y=void 0===i.Total_Acres?"":i.Total_Acres,b=void 0===i.Parcel_Primary_Use?"":i.Parcel_Primary_Use,v=void 0===i.Building_Use_Code?"":i.Building_Use_Code,w=void 0===i.Sale_Date?"":i.Sale_Date,x=void 0===i.Sale_Price?"":n(i.Sale_Price),_=void 0===i.Vol_Page?"":i.Vol_Page,T=void 0===i.Prior_Appraised_Total?"":n(i.Prior_Appraised_Total),S=void 0===i.Prior_Assessed_Total?"":n(i.Prior_Assessed_Total),B=void 0===i.Prior_Assessment_Year?"":i.Prior_Assessment_Year,E=(void 0===i.geometry||i.geometry,void 0===i.Map?"":$.trim(i.Map)),C=void 0===i.objectid?"":i.objectid,P=void 0===i.LAT?"":i.LAT,D=void 0===i.LON?"":i.LON,k=void 0===i.AcctNum?"":i.AcctNum,A=void 0===i.Image_Path?"":i.Image_Path;"yes"===M.useUniqueIdforParcelMap?(le=o,r=o):(le=d,r=d),s="yes"===M.useVisionForTaxBillUrl?k:o,oe=C,I=d;const F=document.getElementById("detail-content"),N=document.createElement("div");N.innerHTML="",N.classList.add("details");let O=M.DetailLinksToInclude,R=M.DetailLinks,q=[];R.forEach((e=>{let t=e;if(O.includes(e)){let e={[t]:{show:"show"}};q.push(e)}else{let e={[t]:{show:"none"}};q.push(e)}}));let V=`\n      <p>\n      <span style="font-family:Tahoma;font-size:14px;"><strong>${l}</strong></span> <br>\n      </p>\n\n      <div>\n      <img class="image" src=${M.imageUrl}${A} alt="Building Photo" width="250" height="125">\n      </div>\n      <p>\n      <span style="font-family:Tahoma;font-size:12px;"><strong>${u} ${c}</strong></span> <br>\n      <span style="font-family:Tahoma;font-size:12px;"><strong>${m}</strong></span> <br>\n      <span style="font-family:Tahoma;font-size:12px;"><strong>${h} ${g} ${f}</strong></span><br>\n  </p>\n  <div id="accordion">\n    <div class="card" id="links" style="display:${q[0].links.show}">\n      <div class="card-header" id="headingOne">\n          <h5 class="mb-0">\n          <button class="btn btn-link collapsed" style="width: fit-content;" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">\n              Property Links\n          </button>\n        </h5>\n    </div>\n\n    \n    <div id="collapseOne" class="collapse show" aria-labelledby="OneFour" data-parent="#accordion">\n           <div class="card-body" style="text-align: left;">\n      `;"yes"===M.includePermitLink&&(V+=`<a class='mx-auto' href=${M.permitLink}?uniqueid=${o} target="_blank"><span style="font-family:Tahoma;font-size:12px;"><strong>Permits</strong></a><br>`),V+=`\n        <table style="width: 100%; font-family: Tahoma; font-size: 12px; border-collapse: collapse; text-align: left;">\n  <tr>\n    <td>\n      <a target="_blank" rel="noopener noreferrer" href="${M.tax_bill}&uniqueId=${s}">\n        <strong>Tax Bills</strong>\n      </a>\n    </td>\n     <td>`,"yes"==M.propertyCardPdf?V+=`<a target="_blank" rel="noopener noreferrer" href="${M.propertyCard}${o}.PDF"><strong>Property Card</strong></a>`:V+=`<a target="_blank" rel="noopener noreferrer" href="${M.propertyCard}${o}"><strong>Property Card</strong></a>`,V+=`</td>\n  </tr>\n  <tr>\n    <td>\n      <a target="_blank" rel="noopener noreferrer" href="https://publicweb-gis.s3.amazonaws.com/PDFs/${M.parcelMapUrl}/Quick_Maps/QM_${r}.pdf">\n        <strong>Parcel Map</strong>\n      </a>\n    </td>\n    <td>\n      <a target="_blank" rel="noopener noreferrer" href="${M.taxMap_Url}${E}.pdf">\n        <strong>Tax Map</strong>\n      </a>\n    </td>\n  </tr>\n  <tr>\n    <td>\n      <a target="_blank" rel="noopener noreferrer" href="https://www.google.com/maps/@${P},${D},17z/@${P},${D},17z/data=!5m1!1e2">\n        <strong>Google Maps</strong>\n      </a>\n    </td>\n    <td>\n      <a target="_blank" rel="noopener noreferrer" href="https://www.bing.com/maps?cp=${P}~${D}&lvl=17.0">\n        <strong>Bing Maps</strong>\n      </a>\n    </td>\n  </tr>\n  <tr><td colspan="2"> &nbsp </td></tr>\n  <tr>\n    <td colspan="2">\n      <a target="_blank" rel="noopener noreferrer" href="${M.pdf_demo}">\n        <strong>Demographics Profile</strong>\n      </a>\n    </td>\n  </tr>\n  <tr>\n    <td colspan="2">\n      <a target="_blank" rel="noopener noreferrer" href="${M.housingUrl}">\n        <strong>Housing Profile</strong>\n      </a>\n    </td>\n  </tr>\n</table>\n\n          </div>\n        </div>\n      </div>\n        <div class="card " id="ids" style="display:${q[1].ids.show}">\n            <div class="card-header" id="headingTwo">\n            <h5 class="mb-0">\n                <button class="btn btn-link collapsed" style="width: fit-content;" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">\n                Property Ids & Uses\n                </button>\n            </h5>\n            </div>\n            <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">\n                <div class="card-body">\n                  <p>\n                  <span style="font-family:Tahoma;font-size:12px;">Unique ID: <strong>${o}</strong></span> <br>\n                  <span style="font-family:Tahoma;font-size:12px;">MBL: <strong>${p}</strong></span> <br>\n                  <span style="font-family:Tahoma;font-size:12px;">Total Acres: <strong>${y}</strong></span> <br>\n                  <span style="font-family:Tahoma;font-size:12px;">Primary Use: <strong>${b}</strong></span> <br>\n                  <span style="font-family:Tahoma;font-size:12px;">Primary Bldg Use: <strong>${v}</strong></span><br>\n                  </p>\n                </div>\n            </div>\n        </div>\n    <div class="card" id="sales" style="display:${q[3].sales.show}" >\n    <div class="card-header" id="headingThree">\n      <h5 class="mb-0">\n        <button class="btn btn-link collapsed" style="width: fit-content;" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">\n          Latest Sale / Transfer\n        </button>\n      </h5>\n    </div>\n    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">\n      <div class="card-body">\n        <p>\n        <span style="font-family:Tahoma;font-size:12px;">Sold on: <strong>${w}</strong></span> <br>\n        <span style="font-family:Tahoma;font-size:12px;">Sale Price: <strong>$${x}</strong></span> <br>\n        <span style="font-family:Tahoma;font-size:12px;">Volume/Page: <strong>${_}</strong></span><br>\n        </p>\n      </div>\n    </div>\n  </div>\n  <div class="card" id="vals" style="display:${q[2].vals.show}">\n    <div class="card-header" id="headingFour">\n        <h5 class="mb-0">\n          <button class="btn btn-link collapsed" style="width: fit-content;" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">\n            Valuations\n          </button>\n        </h5>\n      </div>\n      <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordion">\n        <div class="card-body">\n            <p>\n            <span style="font-family:Tahoma;font-size:12px;"><strong>Valuations:</strong></span><br>\n            <span style="font-family:Tahoma;font-size:12px;">GL Year: <strong>${B}</strong></span> <br>\n            <span style="font-family:Tahoma;font-size:12px;">Assessment: <strong>$${S}</strong></span> <br>\n            <span style="font-family:Tahoma;font-size:12px;">Appraised: <strong>$${T}</strong></span> <br>\n            <span style="font-family:Tahoma;font-size:12px;"></span>\n            </p>\n        </div>\n    </div>\n  </div>\n</div>\n    `,N.innerHTML=V,$("#details-spinner").hide(),F.appendChild(N),L&&$(".abutters-zoom").trigger("click"),L=!1}function tt(e,t,a){X={isChanged:!0,item:a};T.graphics.removeAll(F);C=t,E=t;const n=new s({geometry:C,symbol:{type:"simple-fill",color:[0,0,0,.1],outline:{color:[145,199,61,1],width:3}},id:"uniqueBufferGraphicId"}),i=C.extent.expand(2);T.graphics.addMany([n]),T.goTo({target:n,extent:i})}function at(e,t,a){X={isChanged:!1,item:""},O=[];let n="uniqueBufferGraphicId";T.graphics.removeAll(F);const i=T.graphics.items.findIndex((e=>e.id===n));if(i>-1&&T.graphics.removeAt(i),O=H.filter((e=>e.GIS_LINK==a)),"no"==sessionStorage.getItem("condos")&&O.length==H.length&&O.length>1)if(N){Z=!1,C=N[0].geometry,E=N[0].geometry;const e={type:"simple-fill",color:[0,0,0,.1],outline:{color:[145,199,61,1],width:4}},t=2,a=C.extent.expand(t),i=new s({geometry:C,symbol:e,id:n});T.graphics.addMany([i]),T.goTo({target:i,extent:a}).catch((function(e){"AbortError"!=e.name&&console.error(e)}))}else{let e=`GIS_LINK = '${a}'`,t=xe.createQuery();t.where=e,t.returnGeometry=!0,t.returnHiddenFields=!0,t.outFields=["*"],xe.queryFeatures(t).then((e=>{let t=e.features[0].geometry;C=t,E=t;const a=C.extent.expand(2);T.goTo({target:t,extent:a}).catch((function(e){"AbortError"!=e.name&&console.error(e)}));const i=new s({geometry:E,symbol:{type:"simple-fill",color:[0,0,0,.1],outline:{color:[145,199,61,1],width:4}},id:n});T.graphics.addMany([i])}))}else{Z=!0;let t=H.filter((t=>t.objectid==e));if(t)if(null!=t[0].geometry&&""!=t[0].geometry){E=t[0].geometry;const e=2,a=E.extent.expand(e);T.goTo({target:E,extent:a}).catch((function(e){"AbortError"!=e.name&&console.error(e)}));const i=new s({geometry:E,symbol:{type:"simple-fill",color:[0,0,0,.1],outline:{color:[145,199,61,1],width:4}},id:n});T.graphics.addMany([i])}else{let e;Z=!1,e=t.filter((e=>{e.GIS_LINK}))?`GIS_LINK = '${a}'`:`GIS_LINK = '${t[0].GIS_LINK}'`;let i=xe.createQuery();i.where=e,i.returnGeometry=!0,i.returnHiddenFields=!0,i.outFields=["*"],xe.queryFeatures(i).then((e=>{let t=e.features[0].geometry;E=t,C=t;const a=C.extent.expand(2);T.goTo({target:t,extent:a}).catch((function(e){"AbortError"!=e.name&&console.error(e)}));const i=new s({geometry:E,symbol:{type:"simple-fill",color:[0,0,0,.1],outline:{color:[145,199,61,1],width:4}},id:n});T.graphics.addMany([i])}))}}U&&(U?.remove(),U=null),R&&(R?.remove(),R=null),R=T.on("click",Ze)}T.when((function(){document.getElementById("zoom-in").onclick=function(){T.zoom+=1},document.getElementById("zoom-out").onclick=function(){T.zoom-=1}})),ae.addEventListener("click",(function(){Ue()})),ne.addEventListener("click",(function(){Ue()})),document.getElementById("searchInput").addEventListener("input",(function(e){S=e.target.value.toUpperCase().replace(/&amp;/g,"&")})),$(document).ready((function(){$("#backButton").on("click",(function(){if(F&&F.length>=1||!0===z||H.length>0)if($("#WelcomeBox").hide(),$("#select-button").prop("disabled",!1),$("#detailBox").hide(),$("#filterDiv").hide(),$("#layerListDiv").hide(),$("#featureWid").show(),$("#total-results").show(),$("#ResultDiv").show(),$("#details-btns").hide(),$("#abut-mail").hide(),$("#detail-content").empty(),$("#backButton").hide(),$("#detailsButton").hide(),$("#abutters-content").hide(),$("#selected-feature").empty(),$("#parcel-feature").empty(),$("#exportResults").hide(),$("#csvExportResults").hide(),$("#csvExportSearch").show(),$("#exportButtons").show(),$("#exportSearch").show(),$("#results-div").css("height","300px"),$(".center-container").show(),T.graphics.removeAll(),T.graphics.addMany(F),F.length>1){const e=F.map((e=>e.geometry.extent)),t=3,a=e.reduce(((e,t)=>e.union(t)),e[0]).expand(t);T.goTo({target:a}).catch((e=>{console.error("Error zooming to extent:",e)}))}else{const e=2,t=F[0].geometry.extent.expand(e);T.goTo({target:F,extent:t})}else $("#total-results").hide(),$("#ResultDiv").hide(),$("#abut-mail").hide(),$("#backButton").hide(),$("#details-btns").hide(),$("#detailBox").hide(),$("#filterDiv").hide(),$("#layerListDiv").hide(),$("#dropdown").show(),$(".center-container").show(),$("#WelcomeBox").show();Q||J?!Q&&J||!J&&Q?(U&&U.remove(),R&&(R?.remove(),R=null),$("#select-button").addClass("btn-warning"),U=T.on("click",We)):Q&&!J?(U&&(U?.remove(),U=null),R&&(R?.remove(),R=null),U=T.on("click",We),$("#select-button").addClass("btn-warning")):(U&&(U?.remove(),U=null),R&&(R?.remove(),R=null),$("#select-button").addClass("btn-warning"),U=T.on("click",We)):(R&&(R?.remove(),R=null),U&&(U?.remove(),U=null),U&&J&&(U?.remove(),U=null),$("#select-button").removeClass("btn-warning"),R=T.on("click",Ze))}))})),$(document).ready((function(){$("#detailsButton").on("click",(function(){$("#detailBox").hide(),$("#featureWid").hide(),$("#result-btns").hide(),$("#total-results").hide(),$("#ResultDiv").hide(),$("#filterDiv").hide(),$("#layerListDiv").hide(),$("#details-btns").show(),$("#abut-mail").show(),$("#detail-content").show(),$("#detailBox").show(),$("#backButton").show(),$("#detailsButton").hide(),$("#abutters-content").hide(),$("#selected-feature").empty(),$("#parcel-feature").empty(),$("#exportResults").hide(),$("#csvExportResults").hide(),$("#csvExportSearch").hide(),$("#exportSearch").hide(),$("#exportButtons").hide(),$("#abutters-title").html("Abutting Parcels (0)"),$("#backButton-div").css("padding-top","0px"),$("#results-div").css("height","300px"),R&&(R?.remove(),R=null),R=T.on("click",Ze);const e=T.graphics.items.findIndex((e=>e.id===A));e>-1&&T.graphics.removeAt(e)}))})),$(document).ready((function(){$("#abutters-attributes").on("click",(function(e){R&&(R?.remove(),R=null),U&&(U?.remove(),U=null),$("#results-div").css("height","300px"),$("#exportButtons").show(),$("#exportResults").show(),$("#exportButtons").show(),$("#exportSearch").hide(),$("#csvExportResults").show(),$("#csvExportSearch").hide(),$("#WelcomeBox").hide(),$("#detailBox").hide(),$("#featureWid").hide(),$("#result-btns").hide(),$("#total-results").hide(),$("#ResultDiv").hide(),$("#details-btns").hide(),$("#abut-mail").hide(),$("#filterDiv").hide(),$("#layerListDiv").hide(),$("#abutters-content").show(),$("#selected-feature").empty(),$("#backButton").show(),$("#detailsButton").show(),$("#parcel-feature").empty(),$("#backButton-div").css("padding-top","78px"),$("#abutters-title").html("Abutting Parcels (0)"),nt(e),te.value=100,Ye("100")}))})),$(document).ready((function(){$("#filterButton").on("click",(function(){$("#WelcomeBox").hide(),$("#exportResults").hide(),$("#csvExportResults").hide(),$("#detailBox").hide(),$("#featureWid").hide(),$("#result-btns").hide(),$("#total-results").hide(),$("#ResultDiv").hide(),$("#details-btns").hide(),$("#abut-mail").hide(),$("#exportSearch").hide(),$("#csvExportSearch").hide(),$("#abutters-content").hide(),$("#layerListDiv").hide(),$("#selected-feature").empty(),$("#backButton").hide(),$("#detailsButton").hide(),$("#dropdown").show(),$("#filterDiv").show(),$("#dropdown").toggleClass("expanded"),$("#sidebar2").css("left","0px"),$("#sidebar2").addClass("collapsed"),$("#results-div").css("left","350px"),$("#left-arrow-2").show(),$("#right-arrow-2").hide(),$("#results-div").css("height","300px"),$("#parcel-feature").empty(),$("#backButton").show(),$("#backButton-div").css("padding-top","0px"),$("#abutters-title").html("Abutting Parcels (0)"),$(".center-container").show()}))})),$(document).ready((function(){$("#layerListBtn").on("click",(function(){$("#WelcomeBox").hide(),$("#exportResults").hide(),$("#csvExportResults").hide(),$("#detailBox").hide(),$("#featureWid").hide(),$("#result-btns").hide(),$("#total-results").hide(),$("#ResultDiv").hide(),$("#details-btns").hide(),$("#abut-mail").hide(),$("#exportSearch").hide(),$("#csvExportResults").hide(),$("#csvExportSearch").hide(),$("#exportButtons").hide(),$("#abutters-content").hide(),$("#selected-feature").empty(),$("#backButton").hide(),$("#detailsButton").hide(),$("#dropdown").show(),$("#filterDiv").hide(),$("#backButton").show(),$("#dropdown").toggleClass("expanded"),$("#sidebar2").css("left","0px"),$("#sidebar2").addClass("collapsed"),$("#results-div").css("left","350px"),$("#left-arrow-2").show(),$("#right-arrow-2").hide(),$("#results-div").css("height","300px"),$("#layerListDiv").show(),$("#parcel-feature").empty(),$("#backButton-div").css("padding-top","0px"),$("#abutters-title").html("Abutting Parcels (0)"),$(".center-container").show()}))})),$("#layerListDiv").hide(),$(document).ready((function(){$("#exportSearch").on("click",(function(e){e.stopPropagation();const t=document.createElement("div");t.style.visibility="hidden",document.body.appendChild(t);const a=document.createElement("ul");D.forEach((function(e){let t=e.objectid,n=e.owner,i=e.coOwner,r=e.mailingAddress,s=(e.mailingAddress2,e.Mailing_City),l=e.Mail_State,o=e.Mailing_Zip,d=(e.location,e.MBL);const c=document.createElement("li");let u;c.classList.add("export-search-list"),u=` ${n} ${i} <br> MBL: ${d} <br> ${r} <br> ${s}, ${l} ${o}`,c.innerHTML+=u,c.setAttribute("object-id",t),a.appendChild(c)})),t.appendChild(a),Qe("search"),document.body.removeChild(t)}))})),$(document).ready((function(){$("#csvExportResults").on("click",(function(e){e.stopPropagation();let t=["Owner","Co-Owner","Mailing Address","Mailing Address 2","Mailing City","Mailing State","Mailing Zip","MBL","Location"].join(",")+"\n";se.forEach((function(e){let a=e.attributes.Owner||"",n=e.attributes.Co_Owner||"",i=e.attributes.Mailing_Address_1||"",r=e.attributes.Mailing_Address_2||"",s=e.attributes.Mailing_City||"",l=e.attributes.Mail_State||"",o=e.attributes.Mailing_Zip?`\t${e.attributes.Mailing_Zip.toString().padStart(5,"0")}`:"",d=e.attributes.Location||"",c=e.attributes.MBL||"";t+=`"${a}","${n}","${i}","${r}","${s}","${l}","${o}","${c}","${d}"\n`}));const a=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");if(void 0!==n.download){const e=URL.createObjectURL(a);n.setAttribute("href",e),n.setAttribute("download","export.csv"),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)}}))})),$(document).ready((function(){$("#csvExportSearch").on("click",(function(e){e.stopPropagation();let t=["Owner","Co-Owner","Mailing Address","Mailing Address 2","Mailing City","Mailing State","Mailing Zip","MBL","Location"].join(",")+"\n";D.forEach((function(e){let a=e.owner||"",n=e.coOwner||"",i=e.mailingAddress||"",r=e.mailingAddress2||"",s=e.Mailing_City||"",l=e.Mail_State||"",o=e.Mailing_Zip?`\t${e.Mailing_Zip.toString().padStart(5,"0")}`:"",d=e.location||"",c=e.MBL||"";t+=`"${a}","${n}","${i}","${r}","${s}","${l}","${o}","${c}","${d}"\n`}));const a=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");if(void 0!==n.download){const e=URL.createObjectURL(a);n.setAttribute("href",e),n.setAttribute("download","export.csv"),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)}}))})),$(document).ready((function(){$("#exportResults").on("click",(function(e){e.stopPropagation();const t=document.createElement("div");t.style.visibility="hidden",document.body.appendChild(t);const a=document.createElement("ul");D.forEach((function(e){let t=e.attributes.OBJECTID,n=e.attributes.Owner,i=e.attributes.Co_Owner,r=e.attributes.Mailing_Address_1,s=(e.attributes.Mailing_Address_2,e.attributes.Mailing_City),l=e.attributes.Mail_State,o=e.attributes.Mailing_Zip,d=(e.location,e.attributes.MBL);const c=document.createElement("li");let u;c.classList.add("abutters-group-list"),u=` ${n} ${i} <br> MBL: ${d} <br> ${r} <br> ${s}, ${l} ${o}`,c.innerHTML+=u,c.setAttribute("object-id",t),a.appendChild(c)})),t.appendChild(a),Qe("details"),document.body.removeChild(t)}))})),$(document).ready((function(){let e;function t(){clearTimeout(e),e=setTimeout((()=>{Ye(currentVal)}),200)}$("#buffer-value").on("change",(function(e){e.stopPropagation(),currentVal=te.value=parseInt(te.value),$("#parcel-feature").empty(),t()})),$("#increase").on("click",(function(e){e.stopPropagation(),currentVal=te.value=parseInt(te.value)+1,$("#parcel-feature").empty(),t()})),$("#decrease").on("click",(function(e){e.stopPropagation(),currentVal=te.value=parseInt(te.value)-1,$("#parcel-feature").empty(),t()})),$("#submit").on("click",(function(e){e.stopPropagation(),e.preventDefault(),currentVal=te.value=parseInt(te.value),$("#parcel-feature").empty(),t()})),$("#buffer-value").on("keypress",(function(e){13==e.which&&(currentVal=te.value=parseInt(te.value),e.preventDefault(),t())})),$(".units").on("click",(function(e){"feet"==e.target.value?(W="feet",$("#unitSelector").html(W)):(W="meters",$("#unitSelector").html(W))}))})),$(document).ready((function(){$(document).on("click",".abutters-zoom",(function(e){if(e.stopPropagation(),e.preventDefault(),"no"===sessionStorage.getItem("condos"))if(G){if(G){let e=`GIS_LINK = '${I}'`,t=xe.createQuery();t.where=e,t.returnGeometry=!0,t.returnHiddenFields=!0,t.outFields=["*"],xe.queryFeatures(t).then((e=>{const t=e.features[0].geometry.extent,a=t.center;t.expand(3);T.goTo({target:a,zoom:14})}))}}else{let e=`OBJECTID = ${oe}`,t=xe.createQuery();t.where=e,t.returnGeometry=!0,t.returnHiddenFields=!0,t.outFields=["*"],xe.queryFeatures(t).then((e=>{const t=e.features[0].geometry.extent,a=t.center;t.expand(3);T.goTo({target:a})}))}else{let e=`OBJECTID = ${oe}`,t=_e.createQuery();t.where=e,t.returnGeometry=!0,t.returnHiddenFields=!0,t.outFields=["*"],_e.queryFeatures(t).then((e=>{let a,n,i,r;e.features>0?_e.queryFeatures(t).then((e=>{let t=_e.createQuery();t.where=`GIS_LINK = ${I}`,t.returnGeometry=!0,t.returnHiddenFields=!0,t.outFields=["*"]})).then((e=>{a=e,n=a.features[0].geometry,i=n.extent,r=i.center})):(a=e,n=a.features[0].geometry,i=n.extent,r=i.center),T.goTo({target:r})}))}}))}));const nt=function(e,t){$("#abutters-title").html("Abutters");let a,n,i,r,s,l,o,d,c,u,p,m=j;if(X.isChanged)a=X.item.attributes.Mailing_Address_1,n=X.item.attributes.Uniqueid,i=X.item.attributes.GIS_LINK,r=X.item.attributes.Owner,p=X.item.attributes.MBL,s=X.item.attributes.Co_Owner,o=X.item.attributes.Mailing_Address_1,d=X.item.attributes.Mailing_Address_2,c=X.item.attributes.Mailing_City,l=X.item.attributes.Mailing_Zip,u=X.item.attributes.Mail_State;else{var h=H.find((function(e){return e.uniqueId===m[1]&&e.objectid===Number(m[0])||e.GIS_LINK===m[1]&&e.objectid===Number(m[0])}));a=void 0===h.mailingAddress?"":h.mailingAddress,n=void 0===h.uniqueId?"":h.uniqueId,i=void 0===h.GIS_LINK?"":h.GIS_LINK,r=void 0===h.owner?"":h.owner,s=void 0===h.coOwner?"":h.coOwner,o=void 0===h.mailingAddress?"":h.mailingAddress,d=void 0===h.mailingAddress2?"":h.mailingAddress2,c=void 0===h.Mailing_City?"":h.Mailing_City,u=void 0===h.Mail_State?"":h.Mail_State,l=void 0===h.Mailing_Zip?"":h.Mailing_Zip,p=void 0===h.MBL?"":h.MBL}const g=document.getElementById("selected-feature"),f=document.createElement("ul");f.classList.add("row"),f.classList.add("list-group");const y=document.createElement("li");let b;y.classList.add("abutters-group-item","col-12"),b=` ${r} ${s} <br> ${o} ${d} <br> ${c}, ${u} ${l}`,y.innerHTML+=b,y.setAttribute("data-id",i),$("#abutters-spinner").hide(),f.appendChild(y),g.appendChild(f)},it=(e,t,a)=>{let n;H=[],document.getElementById("suggestions").innerHTML="",B&&(S=e.replace(/&amp;/g,"&"));let i=S;if(!(i?.length<3)||t||i||a){let e,r;$("#dropdown").toggleClass("expanded"),$("#details-btns").hide(),$("#abut-mail").hide(),$("#result-btns").hide(),$("#backButton").hide(),$("#detailsButton").hide(),$("#featureWid").empty(),$("#exportSearch").hide(),$("#csvExportResults").hide(),$("#exportButtons").hide(),e=`\n          Street_Name LIKE '%${i}%' OR \n          MBL LIKE '%${i}%' OR \n          Location LIKE '%${i}%' OR \n          Co_Owner LIKE '%${i}%' OR \n          Uniqueid LIKE '%${i}%' OR \n          Owner LIKE '%${i}%' OR \n          GIS_LINK LIKE '%${i}%'\n      `,t?r=t:K?(r=a,Q=!0):L?r=t:(r=Te.createQuery(),r.where=e,r.returnGeometry=!1,r.returnHiddenFields=!0,r.outFields=["*"]),Te.queryFeatures(r).then((e=>{if(e.features.length>0){let i;n=e.features,"MISMATCH"===e.features[0].attributes.Match_Status&&"Condominium"===e.features[0].attributes.Parcel_Type&&0==Q&&(V=!0),n.forEach((function(e){if(""!==e.attributes.Owner){let t=e.attributes.OBJECTID,a=e.attributes.Location,n=e.attributes.Uniqueid,i=e.attributes.GIS_LINK,r=e.attributes.Co_Owner,s=e.attributes.Owner,l=e.attributes.MBL,o=e.geometry,d=e.attributes.Mailing_Address_1,c=e.attributes.Mailing_Address_2,u=e.attributes.Mailing_City,p=e.attributes.Mail_State,m=e.attributes.Mailing_Zip,h=e.attributes.Total_Acres,g=e.attributes.Parcel_Primary_Use,f=e.attributes.Building_Use_Code,$=e.attributes.Parcel_Type,b=e.attributes.Design_Type,v=e.attributes.Zoning,w=e.attributes.Neighborhood,x=e.attributes.Land_Type_Rate,_=e.attributes.Functional_Obs,T=e.attributes.External_Obs,I=y(e.attributes.Sale_Date),L=e.attributes.Sale_Price,S=e.attributes.Vol_Page,M=e.attributes.Assessed_Total,B=e.attributes.Appraised_Total,E=e.attributes.Influence_Factor,C=e.attributes.Influence_Type,P=e.attributes.Land_Type,D=e.attributes.Prior_Assessment_Year,k=e.attributes.Prior_Assessed_Total,A=e.attributes.Prior_Appraised_Total,F=e.attributes.Map,N=e.attributes.Lat,O=e.attributes.Lon,R=e.attributes.Image_Path,U=e.attributes.AcctNum,q=e.attributes.Match_Status;H.push(new je(t,a,n,i,r,s,l,o,d,c,u,p,m,h,g,f,$,b,v,w,x,_,T,I,L,S,M,B,E,C,P,D,k,A,F,N,O,R,U,q))}})),"no"===sessionStorage.getItem("condos")?(i=xe.createQuery(),i.where=r.where,i.returnDistinctValues=!1,i.returnGeometry=!0,i.outFields=["*"]):(i=_e.createQuery(),i.where=r.where,i.returnDistinctValues=!1,i.returnGeometry=!0,i.outFields=["*"]);let s=null;K?i.where=a.where:L&&(i.where=t.where,s=!0),function(e,t,a){"no"===sessionStorage.getItem("condos")?xe.visible=!0:_e.visible=!0,$(".spinner-container").show();const n=!0;let i,r,s,l;i=`\n          Street_Name LIKE '%${e}%' OR \n          MBL LIKE '%${e}%' OR \n          Location LIKE '%${e}%' OR \n          Co_Owner LIKE '%${e}%' OR \n          Uniqueid LIKE '%${e}%' OR \n          Owner LIKE '%${e}%' OR \n          GIS_LINK LIKE '%${e}%'\n      `,a?r=a:(K||L)&&(r=a,n=!0),"no"===sessionStorage.getItem("condos")?xe.queryFeatures(r).then((function(n){if(l=n.features,n.features.length>=0)if(l=n.features,N=n.features,V){let a="",n="";const i=Ie.createQuery();i.where=r.where,i.returnGeometry=!1,i.outFields=["*"],Ie.queryFeatures(i).then((function(e){a=e.features;const t=e.features[0].attributes.GIS_LINK;let n=xe.createQuery();return n.where=`GIS_LINK = '${t}'`,n.returnGeometry=!0,n.returnHiddenFields=!0,n.outFields=["*"],xe.queryFeatures(n)})).then((function(i){l=i.features,n=i.features,N=i.features,Ge(i,T.graphics,""),ze(i.features),t&&rt(a,n,e)})).catch((function(e){console.error("Error querying features: ",e)}))}else N=n.features,Ge(n,T.graphics,""),ze(n.features),t&&rt(l,e),V=!1;else if(1===n.features.length&&H.length>2){const a=Ie.createQuery();a.where=i,a.returnGeometry=!1,a.outFields=["*"],Ie.queryFeatures(a).then((function(a){Ge(a.features),ze(),t&&rt(l,e)}))}else{const e=Ie.createQuery();e.where=a.where,e.returnGeometry=!1,e.outFields=["*"],0==n.features.length&&Ie.queryFeatures(e).then((function(e){l=e.features,s=e.features[0].attributes.GIS_LINK;let a=e.features[0].attributes.Uniqueid;N=e.features,Ge(e,T.graphics),ze(e.features),t&&(G=!0,rt(l,a))}))}})):_e.queryFeatures(r).then((function(e){if(l=e.features,e.features.length>0){const a=e.features[0].attributes.Uniqueid;Ge(e,T.graphics,""),t&&rt(l,a)}ze(e.features)})),U&&(U?.remove(),U=null),R&&(R?.remove(),R=null),K?($("#select-button").addClass("btn-warning"),U=T.on("click",We)):(R=T.on("click",Ze),$("#select-button").removeClass("btn-warning")),Q=!1,J=!1}(S,s,i)}})).catch((e=>{console.error("Error querying for details:",e)}))}else Ue()};function rt(e,t,a){let n=e,i=t;changeAbuttersZoom=!0,n.length<=0&&(Ue(),alert("Search resulted in an error, please try again."));let r=n[0].attributes.Uniqueid,s=n[0].attributes.OBJECTID,l=i[0].attributes.OBJECTID;$("#details-spinner").show(),$("#WelcomeBox").hide(),$("#featureWid").hide(),$("#result-btns").hide(),$("#abutters-content").hide(),$("#details-btns").show(),$("#abut-mail").show(),$("#detailBox").show(),$("#backButton").show(),$("#detailsButton").hide(),$("#detail-content").empty(),$("#selected-feature").empty(),$("#exportButtons").hide(),$("#exportSearch").hide(),$("#exportResults").hide(),$("#csvExportResults").hide(),$("#csvExportSearch").hide(),$(".center-container").hide(),$("#results-div").css("height","300px"),$("#backButton-div").css("padding-top","0px"),document.getElementById("total-results").style.display="none",et(s,r),at(l,0,r),$("#total-results").hide(),$("#ResultDiv").hide(),z=!0,V=!1,L=!1,urlSearch=!1}const st=function(){const e={},t=window.location.search.substring(1).split("&");for(let a=0;a<t.length;a++){const n=t[a].split("=");n[0]&&n[1]&&(e[decodeURIComponent(n[0])]=decodeURIComponent(n[1].replace(/\+/g," ")))}return e}().uniqueid;let lt,ot=`Uniqueid = '${st}'`;if(st){L=!0;T.when((function(){query=Te.createQuery(),query.where=ot,query.returnGeometry=!1,query.returnHiddenFields=!0,query.outFields=["*"],query=Te.createQuery(),query.where=ot,query.returnGeometry=!1,query.returnHiddenFields=!0,query.outFields=["*"],Ie.queryFeatures(query).then((e=>{let t=e.features[0].attributes,a=(t.Uniqueid,t.Building_Type);"MISMATCH"===t.Match_Status&&"Condominium"===a&&(V=!0),it(null,query)}))})).catch((function(e){console.error("Error occurred while the view was loading: ",e)}))}document.getElementById("searchInput").addEventListener("input",(function(e){H=[],$("#sidebar2").css("left","-350px"),$("#sidebar2").removeClass("collapsed"),$("#results-div").css("left","0px"),$("#dropdown").toggleClass("expanded"),$("#dropdown").hide(),$("#result-btns").hide(),$("#details-btns").hide(),$("#abut-mail").hide();var t=e.target.value.toUpperCase();H=[],secondList=[],F=[],$("#select-button").removeClass("btn-warning"),$("#searchInput ul").remove(),$("#suggestions").hide(),$("#featureWid").empty(),$("#featureWid").hide(),$("#ResultDiv").hide(),$("#dropdown").removeClass("expanded"),$("#dropdown").hide(),$("#result-btns").hide(),$("#details-btns").hide(),$("#abut-mail").hide(),$("#right-arrow-2").show(),$("#left-arrow-2").hide(),$("#abutters-content").hide(),$("#abutters-content").hide(),$("#selected-feature").empty(),$("#parcel-feature").empty(),$("#backButton").hide(),$("#detailBox").hide(),$("#exportSearch").hide(),$("#csvExportSearch").hide(),$("#csvExportResults").hide(),$("#exportButtons").hide(),R&&(R?.remove(),R=null),U&&(U?.remove(),U=null),$("#dropdown").show(),$("#WelcomeBox").show(),$(".center-container").show(),document.getElementById("suggestions").innerHTML="",$("#featureWid").empty(),T.graphics.removeAll();let a=`\n            Street_Name LIKE '%${t}%' OR \n            MBL LIKE '%${t}%' OR \n            Location LIKE '%${t}%' OR \n            Co_Owner LIKE '%${t}%' OR \n            Uniqueid LIKE '%${t}%' OR \n            Owner LIKE '%${t}%' OR\n            GIS_LINK LIKE '%${t}%'\n        `,n=Ie.createQuery();n.where=a,n.returnGeometry=!1,n.outFields=["Street_Name","MBL","Location","Co_Owner","Uniqueid","Owner","GIS_LINK"];let i=new Set;Ie.queryFeatures(n).then((e=>{let a=document.getElementById("suggestions");a.innerHTML="",e.features.forEach((e=>{["Street_Name","MBL","Location","Co_Owner","Uniqueid","Owner","GIS_LINK"].forEach((n=>{let r=e.attributes[n];if(r&&r.includes(t)&&!i.has(r)){let e=document.createElement("div");e.className="list-group-item",e.innerText=`${r}`,a.appendChild(e),i.add(r),a.style.display="block",e.addEventListener("click",(function(e){B=!0,it(e.target.innerHTML),B=!1}))}}))}))}))})),document.querySelector(".form-inline").addEventListener("submit",(function(e){"no"===sessionStorage.getItem("condos")?xe.visible=!0:_e.visible=!0,H=[],T.graphics.removeAll(),F=[],e.preventDefault(),$("#featureWid").empty(),$("#selected-feature").empty(),R&&(R?.remove(),R=null),U&&(U?.remove(),U=null)})),document.addEventListener("click",(function(e){"searchInput"!==e.target.id&&(document.getElementById("suggestions").style.display="none")})),document.getElementById("searchButton").addEventListener("click",(function(){$("#sidebar2").css("left","-350px"),$("#sidebar2").removeClass("collapsed"),$("#results-div").css("left","0px"),$("#exportResults").hide(),$("#csvExportResults").hide(),clearTimeout(lt),lt=setTimeout((()=>{"no"===sessionStorage.getItem("condos")?xe.visible=!0:_e.visible=!0,$("#lasso").removeClass("btn-warning"),$("#select-button").removeClass("btn-warning"),$("dropdown").empty(),$("#featureWid").empty(),$("#abutters-content").hide(),$("#selected-feature").empty(),$("#parcel-feature").empty(),$("#total-results").show(),$("#ResultDiv").hide(),$("#backButton").hide(),$("#detailsButton").hide(),$("#detailBox").hide(),$("#result-btns").hide(),$("#details-btns").hide(),$("#abut-mail").hide(),$("#abutters-title").html("Abutting Parcels (0)"),F=[],T.graphics.removeAll(),R&&(R?.remove(),R=null),U&&(U?.remove(),U=null),it()}),300)})),$(document).ready((function(){ue={streetName:null,owner:null,appraisedValueMin:null,appraisedValueMax:null,assessedValueMin:null,assessedValueMax:null,zoningType:null,neighborhoodType:null,propertyType:null,buildingType:null,buildingUseType:null,designType:null,acresValueMin:null,acresValueMax:null,soldOnMin:null,soldOnMax:null,soldPMin:null,soldPMax:null},$("#streetFilter").on("calciteComboboxChange",(function(e){let t;if(ue.streetName=e.target.value,""!==ue.streetName&&void 0!==ue.streetName&&null!==ue.streetName)Ae("Street_Name",e.target.value),Ne("Street_Name",e.target.value);else{clearTimeout(t),t=setTimeout((()=>{a()}),600)}})),$("#ownerFilter").on("calciteComboboxChange",(function(e){if(ue.owner=e.target.value,""!==ue.owner&&void 0!==ue.owner&&null!==ue.owner)Ae("Owner",e.target.value),Ne("Owner",e.target.value);else{let e;clearTimeout(e),e=setTimeout((()=>{a()}),600)}})),$("#app-val-min, #app-val-max").on("input",(function(){var e=$("#app-val-min").val(),t=$("#app-val-max").val();e=e.replace(/^\$/,"").replace(/,/g,""),t=t.replace(/^\$/,"").replace(/,/g,"");var a=parseInt(e,10),n=parseInt(t,10);if(!isNaN(a)&&!isNaN(n)){var i=a.toLocaleString(),r=n.toLocaleString();$("#app-val-min").val("$"+i),$("#app-val-max").val("$"+r),ue.appraisedValueMin=a,ue.appraisedValueMax=n}!isNaN(a)&&!isNaN(n)&&a<=n&&e.length>=6&&t.length>=6&&(ue.appraisedValueMin=a,ue.appraisedValueMax=n,Ae("Appraised_Total",a,n),Ne("Appraised_Total",a,n))})),$("#assess-val-min, #assess-val-max").on("input",(function(){var e=$("#assess-val-min").val(),t=$("#assess-val-max").val();e=e.replace(/^\$/,"").replace(/,/g,""),t=t.replace(/^\$/,"").replace(/,/g,"");var a=parseInt(e,10),n=parseInt(t,10);if(!isNaN(a)&&!isNaN(n)){var i=a.toLocaleString(),r=n.toLocaleString();$("#assess-val-min").val("$"+i),$("#assess-val-max").val("$"+r),ue.assessedValueMin=a,ue.assessedValueMax=n}!isNaN(a)&&!isNaN(n)&&a<=n&&e.length>=6&&t.length>=6?(ue.assessedValueMin=a,ue.assessedValueMax=n,Ae("Assessed_Total",a,n),Ne("Assessed_Total",a,n)):console.log("Invalid input values: ",a,n)})),$("#propertyFilter").on("calciteComboboxChange",(function(e){if(ue.propertyType=e.target.value,""!==e.target.value&&void 0!==e.target.value&&null!==e.target.value)Ae("Parcel_Type",e.target.value),Ne("Parcel_Type",e.target.value);else{!function(){let e;clearTimeout(e),e=setTimeout((()=>{a()}),600)}()}})),$("#zoningFilter").on("calciteComboboxChange",(function(e){if(ue.zoningType=e.target.value,""!==e.target.value&&void 0!==e.target.value&&null!==e.target.value)Ae("Zoning",e.target.value),Ne("Zoning",e.target.value);else{let e;clearTimeout(e),e=setTimeout((()=>{a()}),600)}})),$("#neighborhoodFilter").on("calciteComboboxChange",(function(e){if(ue.neighborhoodType=e.target.value,""!==e.target.value||void 0!==e.target.value||null!==e.target.value)Ae("Neighborhood",e.target.value),Ne("Neighborhood",e.target.value);else{let e;clearTimeout(e),e=setTimeout((()=>{a()}),600)}})),$("#buildingFilter").on("calciteComboboxChange",(function(e){if(ue.buildingType=e.target.value,""!==e.target.value&&void 0!==e.target.value&&null!==e.target.value)Ae("Building_Type",e.target.value),Ne("Building_Type",e.target.value);else{let e;clearTimeout(e),e=setTimeout((()=>{a()}),600)}})),$("#buildingUseFilter").on("calciteComboboxChange",(function(e){if(ue.buildingUseType=e.target.value,""!==e.target.value&&void 0!==e.target.value&&null!==e.target.value)Ae("Building_Use_Code",e.target.value),Ne("Building_Use_Code",e.target.value);else{let e;clearTimeout(e),e=setTimeout((()=>{a()}),600)}})),$("#designTypeFilter").on("calciteComboboxChange",(function(e){if(ue.designType=e.target.value,""!==e.target.value&&void 0!==e.target.value&&null!==e.target.value)Ae("Design_Type",e.target.value),Ne("Design_Type",e.target.value);else{let e;clearTimeout(e),e=setTimeout((()=>{a()}),600)}})),$("#acres-val-min, #acres-val-max").on("input",(function(){var e=parseFloat($("#acres-val-min").val()),t=parseFloat($("#acres-val-max").val()),a=$("#acres-val-min").val().trim(),n=$("#acres-val-max").val().trim();!isNaN(e)&&!isNaN(t)&&e<=t&&a.length>=0&&n.length>=0?(ue.acresValueMin=e,ue.acresValueMax=t,Ae("Total_Acres",e,t),Ne("Total_Acres",e,t)):console.log("Invalid input values: ",e,t)})),$("#sold_calendar_lowest").on("calciteDatePickerChange",(function(){var e=$("#sold_calendar_lowest").val(),t=$("#sold_calendar_highest").val();ue.soldOnMin=e,ue.soldOnMax=t,Ae("Sale_Date",e,t),Ne("Sale_Date",e,t)})),$("#sold_calendar_highest").on("calciteDatePickerChange",(function(){var e=new Date($("#sold_calendar_lowest").val()),t=new Date($("#sold_calendar_highest").val());e.setDate(e.getDate()+1),t.setDate(t.getDate()+1);var a=e.toISOString().split("T")[0],n=t.toISOString().split("T")[0];ue.soldOnMin=a,ue.soldOnMax=n,Ae("Sale_Date",a,n),Ne("Sale_Date",a,n)}));let e,t=null;function a(){const e=["#designTypeFilter","#buildingUseFilter","#buildingFilter","#neighborhoodFilter","#zoningFilter","#propertyFilter","#ownerFilter","#streetFilter"].map((e=>$(e).val())).every((function(e){return 0===e.length}));return t!==e&&(e&&i(),t=e),e}async function n(){let e=[],t=["Appraised_Total","Assessed_Total","Total_Acres","Sale_Date","Sale_Price"];for(let a of t){let t=Te.createQuery();t.outStatistics=[{statisticType:"max",onStatisticField:a,outStatisticFieldName:"maxValue"},{statisticType:"min",onStatisticField:a,outStatisticFieldName:"minValue"}];try{let n,i=await Te.queryFeatures(t);if("Sale_Date"===a){let e=new Date(i.features[0].attributes.maxValue),t=new Date(i.features[0].attributes.minValue);n={[a]:{min:t,max:e}}}else{let e=i.features[0].attributes.maxValue,t=i.features[0].attributes.minValue;n={[a]:{min:t,max:e}}}e.push(n)}catch(e){console.error("Error querying features:",e)}}var a;a=e,[{fieldName:"Appraised_Total",minInput:"#app-val-min",maxInput:"#app-val-max",index:0},{fieldName:"Assessed_Total",minInput:"#assess-val-min",maxInput:"#assess-val-max",index:1},{fieldName:"Total_Acres",minInput:"#acres-val-min",maxInput:"#acres-val-max",index:2},{fieldName:"Sale_Date",minInput:"#sold_calendar_lowest",maxInput:"#sold_calendar_highest",index:3},{fieldName:"Sale_Price",minInput:"#saleP-val-min",maxInput:"#saleP-val-max",index:4}].forEach((function(e){if("Sale_Date"==e.fieldName){const i=$(e.minInput),r=$(e.maxInput);Be(e.minInput),Be(e.maxInput),i.empty(),r.empty();var t=a[e.index][e.fieldName].min,n=a[e.index][e.fieldName].max;let s=new Date(t),l=new Date(n),o=`${s.getFullYear()}-${("0"+(s.getMonth()+1)).slice(-2)}-${("0"+s.getDate()).slice(-2)}`,d=`${l.getFullYear()}-${("0"+(l.getMonth()+1)).slice(-2)}-${("0"+l.getDate()).slice(-2)}`;i.val(o),r.val(d),Ee(e.minInput,o),Ee(e.maxInput,d)}else{Be(e.minInput),Be(e.maxInput);const t=$(e.minInput),n=$(e.maxInput),i=t.value=a[e.index][e.fieldName].min,r=n.value=a[e.index][e.fieldName].max;let s,l;"Total_Acres"!==e.fieldName?(s="$"+i.toLocaleString(),l="$"+r.toLocaleString()):(s=i.toLocaleString(),l=r.toLocaleString()),t.val(s),n.val(l),Ee(e.minInput,s),Ee(e.maxInput,l)}}))}function i(){clearTimeout(e),e=setTimeout((()=>{!function(){ce=!0,t=null,$("#lasso").removeClass("btn-warning"),$("#searchInput ul").remove(),$("#searchInput").val="",document.getElementById("searchInput").value="",S="",searchTerm="",H=[],secondList=[],me=[{layer:_e,field:"Appraised_Total",filterSelector:"#app-val-min",filterSelector2:"#app-val-max"},{layer:_e,field:"Assessed_Total",filterSelector:"#assess-val-min",filterSelector2:"#assess-val-max"},{layer:_e,field:"Total_Acres",filterSelector:"#acres-val-min",filterSelector2:"#acres-val-max"},{layer:_e,field:"Sale_Date",filterSelector:"#sold_calendar_lowest",filterSelector2:"#sold_calendar_highest"},{layer:_e,field:"Sale_Price",filterSelector:"#saleP-val-min",filterSelector2:"#saleP-val-max"}],pe=[{layer:_e,field:"Street_Name",filterSelector:"#streetFilter",alias:"Street_Name",message:"Select a Street Name"},{layer:_e,field:"Owner",filterSelector:"#ownerFilter",message:"Select a Owner"},{layer:_e,field:"Parcel_Type",filterSelector:"#propertyFilter",alias:"Parcel_Type",message:"Select a Property Type"},{layer:_e,field:"Building_Type",filterSelector:"#buildingFilter",message:"Select a Building Type"},{layer:_e,field:"Building_Use_Code",filterSelector:"#buildingUseFilter",message:"Select a Building Use Type"},{layer:_e,field:"Design_Type",filterSelector:"#designTypeFilter",message:"Select a Design Type"},{layer:_e,field:"Zoning",filterSelector:"#zoningFilter",message:"Select a Zone"},{layer:_e,field:"Neighborhood",filterSelector:"#neighborhoodFilter",message:"Select a Neighborhood"}],he=[{layer:_e,field:"Appraised_Total",filterSelector:"#streetFilter",minInput:"app-val-min",maxInput:"app-val-max",minValField:"appraisedValueMin",maxValueField:"appraisedValueMax",index:0},{layer:_e,field:"Assessed_Total",filterSelector:"#ownerFilter",minInput:"assess-val-min",maxInput:"assess-val-max",minValField:"assessedValueMin",maxValueField:"assessedValueMax",index:1},{layer:_e,field:"Total_Acres",filterSelector:"#propertyFilter",minInput:"acres-val-min",maxInput:"acres-val-max",minValField:"acresValueMin",maxValueField:"acresValueMax",index:2},{layer:_e,field:"Sale_Date",filterSelector:"#buildingFilter",minInput:"sold_calendar_lowest",maxInput:"sold_calendar_highest",minValField:"soldOnMin",maxValueField:"soldOnMax",index:3},{layer:_e,field:"Sale_Price",filterSelector:"#buildingUseFilter",minInput:"saleP-val-min",maxInput:"saleP-val-max",minValField:"soldPMin",maxValueField:"soldPMax",index:4}],$("#result-btns").hide(),$("#details-btns").hide(),$("#abut-mail").hide(),$("#dropdown").hide(),$("#right-arrow-2").show(),$("#left-arrow-2").hide(),$("#abutters-content").hide(),$("#selected-feature").empty(),$("#parcel-feature").empty(),$("#backButton").show(),$("#exportResults").hide(),$("#csvExportResults").hide(),$("#csvExportSearch").hide(),$("#exportSearch").hide(),$("#total-results").hide(),$("#ResultDiv").hide(),$("#featureWid").hide(),$("#exportButtons").hide(),$("#dropdown").show(),$("#WelcomeBox").hide(),$("#select-button").attr("title","Add to Selection Enabled"),document.getElementById("suggestions").innerHTML="",$("#distanceButton").removeClass("btn-warning"),$("#distanceButton").addClass("bg-info"),$("#areaButton").removeClass("btn-warning"),$("#distanceButton").addClass("bg-info"),$("#featureWid").empty(),T.ui.remove(be),be&&(be.destroy(),be=null),T.graphics.removeAll(),F=[],Object.keys(ue).forEach((e=>{ue[e]=null}));const e=$("#streetFilter"),a=$("#ownerFilter"),i=$("#propertyFilter"),r=$("#buildingFilter"),s=$("#buildingUseFilter"),l=$("#designTypeFilter"),o=$("#zoningFilter"),d=$("#neighborhoodFilter"),c=$("#sold_calendar_lowest"),u=$("#sold_calendar_highest");e.empty(),a.empty(),i.empty(),r.empty(),s.empty(),l.empty(),o.empty(),d.empty(),c.value="",u.value="",c.activeDate=null,u.activeDate=null,Oe(0,"Street_Name","#streetFilter","Select a Street Name"),Oe(0,"Owner","#ownerFilter","Select a Owner"),Oe(0,"Parcel_Type","#propertyFilter","Select a Property Type"),Oe(0,"Building_Type","#buildingFilter","Select a Building Type"),Oe(0,"Building_Use_Code","#buildingUseFilter","Select a Building Use"),Oe(0,"Design_Type","#designTypeFilter","Select a Design Type"),Oe(0,"Zoning","#zoningFilter","Select a Zone"),Oe(0,"Neighborhood","#neighborhoodFilter","Select a Neighborhood"),n(),$(".wrapper .x-button").click(),$("#streetFilter").value=""}()}),600)}document.addEventListener("DOMContentLoaded",(()=>{t=a()})),$("#saleP-val-min, #saleP-val-max").on("input",(function(){var e=$("#saleP-val-min").val(),t=$("#saleP-val-max").val();e=e.replace(/^\$/,"").replace(/,/g,""),t=t.replace(/^\$/,"").replace(/,/g,"");var a=parseInt(e,10),n=parseInt(t,10);if(isNaN(a)||isNaN(n))console.log("Invalid input");else{var i=a.toLocaleString(),r=n.toLocaleString();$("#saleP-val-min").val("$"+i),$("#saleP-val-max").val("$"+r),ue.soldPMin=a,ue.soldPMax=n,Ae("Sale_Price",a,n),Ne("Sale_Price",a,n)}})),n(),$("#submitFilter").on("click",(function(){!function(){let e=[];if(null!==ue.streetName&&ue.streetName.length>1)if(Array.isArray(ue.streetName)){const t=ue.streetName.map((e=>`Street_Name LIKE '%${e.trim()}%'`));e.push(`(${t.join(" OR ")})`)}else e.push(`(Street_Name LIKE '%${ue.streetName.trim()}%')`);if(null!==ue.owner&&ue.owner.length>1)if(Array.isArray(ue.owner)){const t=ue.owner.map((e=>`Owner LIKE '%${e.trim()}%'`));e.push(`(${t.join(" OR ")})`)}else e.push(`(Owner LIKE '%${ue.owner.trim()}%')`);if(null!==ue.appraisedValueMin&&null!==ue.appraisedValueMax&&e.push(`Appraised_Total BETWEEN ${ue.appraisedValueMin} AND ${ue.appraisedValueMax}`),null!==ue.assessedValueMin&&null!==ue.assessedValueMax&&e.push(`Assessed_Total BETWEEN ${ue.assessedValueMin} AND ${ue.assessedValueMax}`),null!==ue.propertyType&&ue.propertyType.length>1)if(Array.isArray(ue.propertyType)){const t=ue.propertyType.map((e=>`Parcel_Type LIKE '%${e.trim()}%'`));e.push(`(${t.join(" OR ")})`)}else e.push(`(Parcel_Type LIKE '%${ue.propertyType.trim()}%')`);if(null!==ue.zoningType&&ue.zoningType.length>1)if(Array.isArray(ue.zoningType)){const t=ue.zoningType.map((e=>`Zoning LIKE '%${e.trim()}%'`));e.push(`(${t.join(" OR ")})`)}else e.push(`(Zoning LIKE '%${ue.zoningType.trim()}%')`);if(null!==ue.neighborhoodType&&ue.neighborhoodType.length>1)if(Array.isArray(ue.neighborhoodType)){const t=ue.neighborhoodType.map((e=>`Neighborhood LIKE '%${e.trim()}%'`));e.push(`(${t.join(" OR ")})`)}else e.push(`(Neighborhood LIKE '%${ue.neighborhoodType.trim()}%')`);if(null!==ue.buildingType&&ue.buildingType.length>1)if(Array.isArray(ue.buildingType)){const t=ue.buildingType.map((e=>`Building_Type LIKE '%${e.trim()}%'`));e.push(`(${t.join(" OR ")})`)}else e.push(`(Building_Type LIKE '%${ue.buildingType.trim()}%')`);if(null!==ue.buildingUseType&&ue.buildingUseType.length>1)if(Array.isArray(ue.buildingUseType)){const t=ue.buildingUseType.map((e=>`Building_Use_Type LIKE '%${e.trim()}%'`));e.push(`(${t.join(" OR ")})`)}else e.push(`(Building_Use_Type LIKE '%${ue.buildingUseType.trim()}%')`);if(null!==ue.designType&&ue.designType.length>1)if(Array.isArray(ue.designType)){const t=ue.designType.map((e=>`Design_Type LIKE '%${e.trim()}%'`));e.push(`(${t.join(" OR ")})`)}else e.push(`(Design_Type LIKE '%${ue.designType.trim()}%')`);null!==ue.acresValueMin&&null!==ue.acresValueMax&&e.push(`Total_Acres BETWEEN ${ue.acresValueMin} AND ${ue.acresValueMax}`),null!==ue.soldOnMin&&null!==ue.soldOnMax&&e.push(`Sale_Date >= '${ue.soldOnMin}' AND Sale_Date <= '${ue.soldOnMax}'`),null!==ue.soldPMin&&null!==ue.soldPMax&&e.push(`Sale_Price BETWEEN ${ue.soldPMin} AND ${ue.soldPMax}`);let t=e.join(" AND ");if("no"===sessionStorage.getItem("condos")){let e=Ie.createQuery();e.where=t,e.returnDistinctValues=!1,e.returnGeometry=!0,e.outFields=["*"],Ue(),it(null,e)}else{let e=Ie.createQuery();e.where=t,e.returnDistinctValues=!1,e.returnGeometry=!0,e.outFields=["*"],Ue(),it(null,e)}}()})),$("#clearFilter").on("click",(function(){i()}))})),$(document).ready((function(){$("#side-Exp").on("click",(function(){$("#sidebar").toggleClass("collapsed"),$("#sidebar").hasClass("collapsed")?($("#small-div").css("right","0px"),$("#right-arrow").hide(),$("#left-arrow").show()):($("#small-div").css("right","250px"),$("#left-arrow").hide(),$("#right-arrow").show())}))})),$(document).ready((function(){$("#Basemap-selector").on("click",(function(){$("#rightPanel").hide(),$("#BookmarksDiv").hide(),$("#AddDataDiv").hide(),$("#ContactDiv").hide(),$("#PrintDiv").hide(),$("#LegendDiv").hide(),$("#Right-Btn-div").show(),$("#BasemapDiv").show(),$("#group-container-right").show()})),$("#Bookmarks-selector").on("click",(function(){$("#rightPanel").hide(),$("#BasemapDiv").hide(),$("#AddDataDiv").hide(),$("#ContactDiv").hide(),$("#PrintDiv").hide(),$("#LegendDiv").hide(),$("#Right-Btn-div").show(),$("#BookmarksDiv").show(),$("#group-container-right").show()})),$("#Print-Esri").on("click",(function(){$("#rightPanel").hide(),$("#BookmarksDiv").hide(),$("#AddDataDiv").hide(),$("#ContactDiv").hide(),$("#BasemapDiv").hide(),$("#Right-Btn-div").show(),$("#PrintDiv").show(),$("#LegendDiv").hide(),$("#group-container-right").show()})),$("#Contact-selector").on("click",(function(){$("#rightPanel").hide(),$("#BookmarksDiv").hide(),$("#AddDataDiv").hide(),$("#BasemapDiv").hide(),$("#Right-Btn-div").hide(),$("#PrintDiv").hide(),$("#Right-Btn-div").show(),$("#ContactDiv").show(),$("#PrintDiv").hide(),$("#LegendDiv").hide(),$("#group-container-right").show()})),$("#addData-selector").on("click",(function(){$(document).keypress((function(e){"Enter"===e.key&&e.preventDefault()})),$("#rightPanel").hide(),$("#BookmarksDiv").hide(),$("#BasemapDiv").hide(),$("#Right-Btn-div").hide(),$("#PrintDiv").hide(),$("#ContactDiv").hide(),$("#Right-Btn-div").show(),$("#AddDataDiv").show(),$("#PrintDiv").hide(),$("#LegendDiv").hide(),$("#group-container-right").show()})),$("#Legend-selector").on("click",(function(){$("#rightPanel").hide(),$("#BookmarksDiv").hide(),$("#BasemapDiv").hide(),$("#Right-Btn-div").hide(),$("#PrintDiv").hide(),$("#ContactDiv").hide(),$("#Right-Btn-div").show(),$("#AddDataDiv").hide(),$("#PrintDiv").hide(),$("#LegendDiv").show(),$("#group-container-right").show()})),$("#right-btn-back").on("click",(function(){$("#group-container-right").hide(),$("#PrintDiv").hide(),$("#AddDataDiv").hide(),$("#BookmarksDiv").hide(),$("#BasemapDiv").hide(),$("#Right-Btn-div").hide(),$("#ContactDiv").hide(),$("#LegendDiv").hide(),$("#rightPanel").show()}))}));var dt={240:"1 inch = 20 feet",600:"1 inch = 50 feet",1200:"1 inch = 100 feet",1800:"1 inch = 150 feet",2400:"1 inch = 200 feet",3600:"1 inch = 300 feet",4800:"1 inch = 400 feet",9600:"1 inch = 800 feet",12e3:"1 inch = 1000 feet",18e3:"1 inch = 1500 feet",24e3:"1 inch = 2000 feet",36e3:"1 inch = 3000 feet",72e3:"1 inch = 6000 feet",144e3:"1 inch = 12000 feet",18e4:"1 inch = 15000 feet"},ct=document.getElementById("scale-dropdown");document.querySelectorAll(".scale-select").forEach((function(e){e.addEventListener("click",(function(e){var t=parseInt(e.target.value),a=e.target.innerHTML;t&&(T.scale=t,console.log(T.scale)),$("#scale-value").val(t).html(a)}))})),T.ui.add(ct);r.watch((()=>[T.stationary,T.scale]),(([e,t])=>{e&&function(e){var t=Math.round(e),a=function(e){var t=Object.keys(dt).reduce((function(t,a){return Math.abs(a-e)<Math.abs(t-e)?a:t}));return dt[t]}(t);a&&$("#scale-value").val(t).html(a)}(t)}));function Re(){var e=document.querySelector(".esri-widget--button.esri-print__refresh-button.esri-icon-refresh");e&&e.click()}$(document).ready((function(){$("#popoverButton").popover({trigger:"hover"})})),$(document).ready((function(){$("#lasso").popover({trigger:"hover"})})),$(document).ready((function(){$("#select-button").popover({trigger:"hover"})})),$(document).ready((function(){$("#clear-btn1").popover({trigger:"hover"})})),$(document).ready((function(){$("#filterButton").popover({trigger:"hover"})})),$(document).ready((function(){$("#layerListBtn").popover({trigger:"hover"})})),$(document).ready((function(){$("#abutters-attributes").popover({trigger:"hover"})})),$(document).ready((function(){$("#abutters-zoom").popover({trigger:"hover"})})),$(document).ready((function(){$("#distanceButton").popover({trigger:"hover"})})),$(document).ready((function(){$("#areaButton").popover({trigger:"hover"})})),T.watch("zoom",(function(e,t){e!==t&&Re()})),T.watch("center",(function(e,t){e!==t&&Re()})),$(document).ready((function(){$("#side-Exp2").on("click",(function(){$("#sidebar2").hasClass("collapsed")?($("#results-div").css("left","0px"),$("#sidebar2").css("left","-350px"),$("#right-arrow-2").show(),$("#left-arrow-2").hide()):($("#results-div").css("left","350px"),$("#sidebar2").css("left","0px"),$("#left-arrow-2").show(),$("#right-arrow-2").hide()),$("#sidebar2").toggleClass("collapsed")}))}))}))}));